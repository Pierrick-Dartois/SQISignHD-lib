#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = {{{0xa559087b8aba293e,0x530d9d6f3443b861,0xbd45ae4ebf26dc7a,0x1b32c38034bea3fa}, {0xc51f8c64595a6b18,0x33ce796185f97a4,0xd49c293472407641,0xb5d8489bcf9fc86}}, {{0x3f84612e499f06e6,0xd4d7e5d2891bfdda,0x4d1c9ef43924dbf4,0x22ae78700a7c051e}, {0x968c788a79be5d32,0xe2494ff2b575587a,0x98dece2a324aeb56,0x22606745e94e3d8e}}, {{0xafb9702f2701c07a,0xa68f27e601231e7a,0xb0b2def23fb1ae63,0x1b0735d0e22646e2}, {0xf7d610ab9aff0cb2,0x22ab2da54449a6cd,0x879786b289f05ad2,0x27e9a960d9a30b8f}}, {{0xb4473cc9ce6d8fdc,0xa6929843d2b0e33,0x323573df607dc234,0x177090488ac8d275}, {0x48e160d843d91fa6,0x3dc40c580a2a8791,0x5cd05a2cfe0fc849,0x124ca8568d61d645}}, {{0x11029293e19583a7,0x6183dfd6ecabc966,0xbc8b4a0ee6c3afdc,0x27a6552ae8200144}, {0x327479d0b900e61e,0xfa17737a346c334a,0x962227d5b972c857,0x17a0ccc3978e0829}}, {{0xc5914f0566c4000,0x66d414a15f360158,0xb9d90250df3e613,0x14b6abbbd230a16b}, {0xfdcf68fb8f0d72c7,0x9c32b2aa57c475ab,0xfecf8852dffd2b69,0x1014f54d900c5092}}, {{0x374555b4163746d1,0x6c7e409b9ab8734d,0x92cf7f70f41afd4b,0x25237dd242682fe5}, {0x973ff340b30e381a,0xae3bb55040acbcc5,0xacc5707b7ffa6c0e,0x557a8c6ec027575}}, {{0xc36c2fab33476f10,0xec7df64e672aa799,0x726793d503066e89,0x27d8c757529b36c6}, {0xe47f5f475c5ae5c2,0x73654dd0456be8d,0xc949ad4db6beaedb,0x170bca892ac93b41}}, {{0x712a34cebd838186,0x4c1394c1cb335dab,0xf127a335aa18a2a4,0x17e9b6c0f596cfe3}, {0xcb9b5ddce8a561dd,0x81dd40aff7f69947,0x9aa197aa40a18a32,0x35619cbdfa2de2}}, {{0x946cb6f3ea0ad623,0x8e4dae69c6abd1d,0x2b7a8c687d3622d,0x151f4978b6838e72}, {0xe5a61ef2ae54a64b,0xfa73cf12e3e2dea5,0xaff76cd3a4472a6,0xb192ef41d4761ea}}, {{0x801acfd8ed70bb3a,0x1359a340f787cdc0,0x7ca4a769e2d51298,0x103141b27be9fbde}, {0xe5368cc6289198e2,0xe534d81bead3f14b,0x3cee66b98ff1e952,0x178853209e6f2820}}, {{0x4025cf2f3f7f1935,0xdf94fa99dd7f6e01,0x7787ea0d25cc3878,0x26bbaf0a9d74ff54}, {0xc93906d2fb7d096c,0x6ce5d77203d13bcc,0x9db5fe4749d14ccc,0x11307e1cfbf85813}}, {{0xc463c2b327fdba1e,0x702760e28ca6c8a9,0xc12ee40de83ad46d,0x21cd02aa0d5b966d}, {0xd5b049dc290281eb,0xa805abce0739bcdc,0xe9cbec08d575d4e7,0x4fc8986dedd38dc}}, {{0x4d0546e833b497c7,0x10a160e842546824,0x6b565394c7359909,0x131a37c6ff088a76}, {0x90dda5f34023210b,0xf6cfca9bba49aa7f,0xb0c29227d797cd24,0x3a82e6c95e90ac0}}, {{0xd0360795da550f0c,0x831168464af8e459,0x5bf82d3a36d8d3c5,0x19ebb11923345242}, {0xccb81465fd1c3572,0xceeea31480a2f19a,0x16092e8280d61315,0x148ffd646285d7d1}}, {{0x346fe6cd74e3d7e8,0xe9c82b78a331e284,0xff2920f3162e1873,0xcd64f5e7b2fc03a}, {0x750179ad1b94431a,0x9e789483b4628465,0x845242d45906b871,0x157fe7bc96ae6bd1}}, {{0xe0b4c14590cfdb9f,0x21caf1bb56532a77,0x2ea4be68fb57585d,0x236356574d6d7f2a}, {0xa2750e9ab07b84bb,0xd371025df947d87c,0x3ff6a1ba9dc7e277,0x18802b13b66ee7db}}, {{0xecb285948a186998,0xf45cc4ebd87cd19e,0x5ba63c40152a186d,0xb2754e18319d67d}, {0x7e45b2f8cee4ff05,0xe639cbade24928dd,0x6f94775da98a896d,0x235abe24b6cec665}}, {{0xcd8d88961f2a2abc,0x45bea734c1d7945a,0xa243eb73d7385de2,0x18930ea66f68f2b0}, {0x52cfa269a0dbd4c8,0xbb9e33d918e0bca2,0xc932c104da6a3f66,0x1447c62822a82e6d}}, {{0xcd76ee15c5626738,0xcac2e9e40f1a916b,0x2ed98027d3a9aabd,0x80a74deee01ef6a}, {0x19a5a421d3901e93,0x497fe3206f879d76,0xb5cd64f9fd7ffe73,0x1c348102bd5b5897}}};
const fp2_t Z_NQR_TABLE[20] = {{{0x94a4cdf18ebca0a3,0xcb335956ae00345a,0x9b7d35b43ed4ba91,0x1c42b370ebc96f81}, {0x89fe3ecf0f97e840,0x7cf908f9488da01,0x1dde366581059cc4,0x809a99e35ea54d1}}, {{0xa83f14fe14750842,0x57bed384a25d07e5,0x4020857838d2405d,0x9880b09a710d008}, {0x10ab550e5676f2f7,0xf740006affd69930,0xcdf4f3c7e0792b1d,0x10c368745aa25389}}, {{0x618f029b73ce9555,0x9d7f6c3d983224e8,0x2e1ca5d89c73f8e9,0x1929e2a9199bfcc6}, {0x782ecf2df3cf9c16,0xbc126af52979f8fb,0x267be5a2ec6abb5f,0x27ec9a1180d5d69c}}, {{0x265d68c874f63522,0xddb13bfcbd623772,0x16a4c6f0f3ebb3a2,0x25d122a3c0125b91}, {0x56ab0677d2ddba3a,0x735f2953e7687e78,0x1056a1fe5c8ce44c,0x848976eb2c1853c}}, {{0x81fa49de03909535,0xb93d70f7cbb11052,0xc1464411d445d330,0x20d6f7da639cf99f}, {0xd1345b3df74aad44,0x66e29724ca0ff2b1,0x357cd2e9e8e5da55,0x6f0f9972a20e8ae}}, {{0xebbf105d03815ed1,0xd1bc1880905f4d5e,0x567160936b745394,0x200efb03cc1de2a7}, {0x3e79700a5471db8a,0xb46ed0cabeb030d2,0x360244895e9d1e00,0x107db528c3e403c7}}, {{0x7375425d3e6c3daf,0xd9c6f80f10186317,0xb1d86f8484734b2b,0x6fdeb7c4ebda62}, {0xd724ba5128996582,0x5f5a008c534af973,0x2ea30852442eb78e,0x1a3c840559e60486}}, {{0x7e25a666e8a6a989,0xaf6fc7fe76cc05a9,0x3f03b4c79a0ae5b6,0x181ccd9949473c77}, {0x8199b5ca9cbc7723,0x94c98cf6ec5b9613,0x770259836cf7ff32,0xb9c5ecb1d94e31d}}, {{0x42f7653ba2aaa1d5,0x2cfb891487465e31,0xc9456db4f77e415f,0x30914c1a62b77fc}, {0xc5cc6838ddfd326a,0x8f57eaa57d6afb7f,0x25d57d53e9dc11af,0x24c329eb60c756ca}}, {{0xd73ff2af89ec94e8,0xfbf03edf9644ec59,0x8fdac0c5e217898c,0x179750a36ae1b5c7}, {0x50c6f51463eff835,0xcb59305fadeb9ddf,0xbc88bed3e1a0bf34,0x5d622dd2a4b9677}}, {{0x77d9afb067f1b298,0x5358d7b500103717,0x5340e2b3036346bc,0x24a19de8b850ff54}, {0xd725644d55e7f7d2,0x65e61a9c07a922a8,0xf91d18ab46b5c993,0xf8ebc1979feedfa}}, {{0x4a09f1fd2562c9cf,0x13f7e1ead3342e80,0xe2aef314933a3da9,0x1f8d1d9205008339}, {0xa92d735e561ccf7a,0xefe5605497a14ed5,0x17a6627c1363e3b5,0x12b93569253a764a}}, {{0xf846f97a8bb594a8,0x953140a0b91a8bce,0x80dfc2e472887b03,0x480c9a9edfdf0ee}, {0xf24ed87218ed7169,0xb4dde8659b8df991,0x432a202696d00f2d,0xbebdb474b93302}}, {{0xc9bf812e06a7717a,0x54bbb29da6761e52,0x2977a1bfb35426c1,0x1de691cb3546f53}, {0x3a89f24c25c3733a,0xec31781feeb13713,0x69b2ac4fd9b12ac3,0x2008d345f575123f}}, {{0x4eb71db51cadce61,0x37d4bd6af20141e8,0x4f0ef26fb9b77136,0x139284963d3c906b}, {0x49da18f76ef5e769,0xd85ed447e16645d8,0x8530b045374210d8,0x1b15611e0f860dde}}, {{0x9ca2ccaac3e30bdc,0x5c48a802c5818030,0x9b070ef3da2bcff0,0x7e0eb1d9ac45824}, {0x70c762416b06c553,0x7cab3b35993fa215,0x8cd9e49c2741044e,0xc6b97ba3975af6d}}, {{0x4b2a6998099f5d62,0x30c3035826f64e26,0xa223166ae7e789c8,0x1cfd95499551b672}, {0x2199bc6b99e3fa1,0x85f31be418593d66,0x185b79cc3840747c,0x1dcef747c4b323d7}}, {{0x9ff09669ed39af4c,0x8e19cd6f5f6edb7c,0x18c959337de851a,0xde0a06057891324}, {0x132d88ce47636497,0xddd7ba2ae27169da,0x2e6ddfdf8bd1f737,0x762541d0821052b}}, {{0xacedb68e5b2cf225,0x3ebc2370edb61bfc,0xb80c89ead70b3a6a,0x8fa73656136af6}, {0x96986c54ab7eba57,0xc2723f15cf82661e,0x6a5d49dd25f7fa82,0x4d62c3991c42aa7}}, {{0xd48f4877629baa0c,0x915f02fe1e8b6c80,0x84e4d5127e60367f,0x16410b0204704a04}, {0x71f78298018492b5,0xccaa9a92c6c80d8d,0xad86fe48efe2346a,0x1ebee53fc37ad728}}};

const digit_t p_cofactor_for_2f[2] = {0x90e0ba1ffe771625, 0xa09eebaf572395ba};

const digit_t p_cofactor_for_3g[3] = {0x0, 0x4000000000000000, 0x3};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 128;
const uint16_t POWER_OF_2 = 126;
const uint16_t P_COFACTOR_FOR_3G_BITLENGTH = 130;
const uint16_t POWER_OF_3 = 78;
