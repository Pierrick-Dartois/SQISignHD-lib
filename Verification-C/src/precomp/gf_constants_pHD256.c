#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = { {{ 0x0d5e5fcfbc269b1a, 0x8ef55183495b90ba, 0x9ad12852432e40dd, 0x12d05eac343ba1e7}, {0x1a5e5ce69bf88e2a, 0xc42bcbd334fa6a15, 0x0741623ad226ef14, 0x25ae968fc090eac8}}, {{ 0x72ebd7e01c485a49, 0x6f4427992918caf5, 0x993f656b041e8b40, 0x1df075afe422fded}, {0x5aecc77da0ffdc4, 0xca8830d05c38283d, 0xc6f0c04e80e58fec, 0x95651402e15cbf93}}, {{ 0xb3ac053ce4bb716, 0xf8dc785a0e09190d, 0xe009564a6e4ed02f, 0xfcb8eb1f997108dc}, {0x136af035a41691d, 0x9f53fd36c6f02c56, 0x8e89f490e9534596, 0x2ab515c4405969c9}}, {{ 0xc8d0bccea19219f4, 0x6172d5b8e1ffea56, 0xbd82c9dd23baaa58, 0x2021dc8ae2f6cc7c}, {0x81dc0e1c645c2038, 0xce5310016c8fcdcb, 0xe2a48be1e6f1d093, 0x1a996f48b5efc27b}}, {{ 0xac9abcb1c59b6271, 0xb30d9eeacaa17e67, 0xe34862df97ebe5a1, 0x149b26946d415151}, {0x457f9c0f47ede9dc, 0xd653c6650c2013ae, 0xcc3fd02c1ef72d18, 0x1ebef12489972609}}, {{ 0xad315f56354ee62a, 0x3819f964ea181395, 0xc58975d47e8e0e54, 0x21a8484ca5f66552}, {0x80a9dfbdfabfa436, 0x938a188e1c1ba7d0, 0xcc2c73d06921c8e5, 0x1f6231ddd685d384}}, {{ 0x83739217c786a58e, 0xbedd634ebb7ca220, 0x23d9bf841f317b99, 0x1a0ac40191569ec3}, {0x93c444b3b597606, 0x7cbbf9ba9484b8f9, 0x43614dceeba44271, 0xabb5f004df191756}}, {{ 0x2b21255ba85f50e1, 0x1b743e9cd63cda76, 0x5b83949d1ab0efd5, 0x1242dd36b61ccdd6}, {0x0a44f5d0f4504c79, 0xba7d947d3954c444, 0xb4a0d747e13e20c0, 0x18066cd10149679b}}, {{ 0xb6bc49d8466b3306, 0xab811be6fe785d65, 0x049ebf9cd554afd5, 0x14c32931669d470e}, {0xf2de73c1f42d0e3c, 0xd37f2c2062c533d0, 0xa4bed8710e25b254, 0x16313c967f7af416}}, {{ 0x73ce04611fc341cf, 0x4376ba2453108be7, 0x438ceaf225f82e7b, 0x192690cd9c834289}, {0x3c429038df885eb, 0x71c1cafb9224757f, 0xe76bfd65077d2e7c, 0xfd2c6d27b4e30d44}}, {{ 0xfb63a84ed4a1bd7, 0xdc6dfda50d772263, 0x840f716c1e32bf0a, 0x9a7f850a11186684}, {0x8e98fa1bffa37a21, 0xc9de3ab5314a7c70, 0x331f76951bb5242c, 0x1ab2e9cd191fad6f}}, {{ 0x219f6dcaa7058699, 0xf33727bb2b7621e1, 0x987953026b42051a, 0x11a5e811fbb60e9e}, {0xe70226d203ce7125, 0x81639a4659eff751, 0x980b6e5186d45c12, 0x25ff9f4db9b1535d}}, {{ 0x8aa60af5cbb1b24, 0xf163fa5f39b3c012, 0x73ff1ceac0af8d57, 0x867d43f885d8d29b}, {0x451575dc32e79013, 0x7e18af8ca3980a0a, 0x83248df270a9297d, 0x1951295054d38f10}}, {{ 0x9247ff2434dc32e7, 0x7d9460635cd60435, 0x1a6fe3aadbc830b4, 0x15d6447e5323a86b}, {0x05f5c027259fdb4, 0x717e6cc6a6c0de08, 0x22548d34fac83794, 0xfe9749171dd0c0ec}}, {{ 0xa2f48c0500698883, 0xcfe65450ee907774, 0x8ad249bb19c4bc06, 0x194adbe8642986f9}, {0x05960438c4d5f2fe, 0x1369fc57be0d1927, 0xca97fed27021b364, 0x2537ac506ea9a925}}, {{ 0x52169cef28c9ea3b, 0x7025565bcb33064c, 0xeda9d5da3b2d49ca, 0x24cac608056be4be}, {0x7b7cac561e9bf55, 0x9cc01717725dcfeb, 0x07deaeb9dd5d84c1, 0x83f0d4fc78af7552}}, {{ 0x83f381306bdac1d7, 0x7d07f00955c5e10e, 0x7166fd230aa21623, 0x146cdf1bac343b97}, {0x345229ae56c1162e, 0xe3cc4fec7564cdd6, 0x1d17ef9dc73a2e0d, 0x2097449123a865c2}}, {{ 0x61fabbd46e65eec, 0x6cb07f7c2a51a67d, 0x05720b57834af93b, 0x513bf7fff2ef0521}, {0xc1ebc2405fc5062, 0x068e634cf916e8ad, 0xe3f135224626d9cd, 0x606b5fcceae3bcdf}}, {{ 0x43278eebf7464a0d, 0x2809d25d7c51ea18, 0x86ec0c1dcb5a5296, 0x14edab47c2febe9e}, {0xe6c412395186fe4f, 0x3536fcdf9136e562, 0xbe7c04498cba3b45, 0x11d332adfef018fb}}, {{ 0x75d084768901f85a, 0xbcf46556bc6c3487, 0x7176a498d8967ac0, 0x19fc3c1d04ac0dc3}, {0xfadc207f784808d1, 0x774aa818d1879561, 0x0cbf70d0a7b2b237, 0x25bd7abbc7d42df6}}};
const fp2_t Z_NQR_TABLE[20] = { {{ 0xbbbca71fc3ddf03, 0x295c140051f216b1, 0xa3b324122a2f562b, 0x760694b146f689d5}, {0xfda5e6e0613159c, 0xce96835ffbc084d3, 0xc61a51a835521fbf, 0xb159533ba1e70c34}}, {{ 0x2fa36df0356534b0, 0x439f358c9d6a8ba4, 0xd40fd4ab8cfa8d07, 0x134da6c37f1790e4}, {0x23a5eb42c7475885, 0xeb6ec268f26eceb4, 0xac284723430c1df0, 0x16c9868ce3958cb4}}, {{ 0xce427801d3cf917d, 0xe96e6bf58cd5232f, 0xb107c9ab174bae8e, 0x19e10d15a7394c07}, {0x37c9d96620bbd586, 0x832ea12d6af28ace, 0x87454a5554145084, 0x25e3ec94fefceedd}}, {{ 0x8949a86141d297e, 0xbad1310a59226462, 0x438792139c356d8a, 0x6481db9405698ac9}, {0xca529eef84cbc37f, 0x27f7bf9fd6de24eb, 0x2e40cffbe9c60fd2, 0x27decc4f39a33e21}}, {{ 0x810d2dd90c065cf, 0x6b4d7c750a613a4f, 0xb3d818bbc9ce7711, 0x8f8346cb83bf0379}, {0xbd87256cc36da7f, 0x619bdf7b283f71b1, 0x48577a51e82e0cb4, 0xe3310e7fc109348a}}, {{ 0x9da2da5e32d1e55, 0x79732d8147bd9bcd, 0xc03bd804a673bf94, 0xef1e2874b72def1b}, {0x1ae1e53cfbbc537b, 0x92a0a3350bbd47b3, 0x5d9d3dc5239c90be, 0x26deffd816c567fb}}, {{ 0xdbb9569db39a7cfe, 0x26dbd1b3b545e20a, 0x64fa6853f8ca7560, 0x27fa5f2e0e17b3ef}, {0xe2c2d129561392b, 0xd948651177cdde20, 0x4257129c7625978e, 0xdd07e322f9170d81}}, {{ 0x89f0c1a61d249384, 0x479da47c72e06a1d, 0xef68533062ae5333, 0x25ec80fec20f23ea}, {0x13305e8873839095, 0x8bb0f82f3a71f27b, 0xc412e48080015590, 0x1102053e7550f5c1}}, {{ 0x2407b7c11bdf587a, 0xf0ce3c3acb91b1cf, 0x331badbe8834921f, 0x25518e7a062b01d6}, {0x5cbf1443de53cca, 0x362a43f0b83ddc1d, 0xc37d75b590e9caa8, 0x62870eabc3b1541a}}, {{ 0xc00105acdf21fa1c, 0xdc50484434e15007, 0x6ef10f694ebcdecc, 0x171469e723a7721d}, {0x4dbc51176bf62373, 0xa8fee7eff27caf1f, 0x77fba1aeeec50ad5, 0x159741fc3992fb57}}, {{ 0xdfc0ac8ea825bb9, 0x0edef17880c77dff, 0x26430c90be052f87, 0x57a306bc610b1529}, {0x7b2401cd9f6387f0, 0x20f6636d1651317d, 0xb050bbe4da7d8f6a, 0x1f0ff9cff2f33cca}}, {{ 0xcd2e68dacc9743c8, 0x9501920d75a3c87a, 0x687a0c9350bdb471, 0x112ad96797f2d6ff}, {0x7a234f892e498169, 0xbc37beb9f1a12fc2, 0xcfc5bca07b986f0a, 0x21c64f31f7d7398e}}, {{ 0xd5287ed33daa260, 0x5cbabf20bb9b3b35, 0x97ca13e9f207c68e, 0xf38116be97740d9c}, {0x209339b2a3fc61f, 0xdf23eaeb37e69898, 0xb47f87df72859d1b, 0x47bc3ec781dd303a}}, {{ 0x7d05f858e921d7eb, 0xfc8e64af06058160, 0x1469bf5fd1ada362, 0x1a8619c34efda563}, {0x05517153ed2d4e7f, 0x5bca704758dcf1bd, 0x69900653384d7813, 0x266573a23097603f}}, {{ 0xac6267aaeb5d11b9, 0x581b6b337324b813, 0x4d87c21d46881368, 0x1e2afab76f19016e}, {0x60a0670ce7291f1, 0xdafb4b9f41a3009b, 0x2ead941a76c67370, 0x627c5a651654a2d0}}, {{ 0x425153f7e7b4e1f, 0x4d4089087ce160e8, 0xe6b3d93c107f085e, 0x2805731a4cef32a3}, {0x16d6788dbc36ebaa, 0x2dbd12bed79d1ddc, 0xd10d4b8ee44311ca, 0x1e0fa5bc297951d6}}, {{ 0x2f5fcba43fc58fb1, 0xdc0048ee069a7a71, 0x74c4246755ac3d3b, 0x1183d48e3ad656ce}, {0x071ddaa4eef3db47, 0xf226a969a6e7bf72, 0x09e11944c1da069c, 0x23787ea9572fc860}}, {{ 0x5042b450e06fabae, 0xa5f0f30973e87674, 0x16193d17bb04fa67, 0x21afbc653a0460ad}, {0x18d9160ce38fadd9, 0xd29538bab83fad32, 0x8680e6591f8b348a, 0x19c62323b5fd30de}}, {{ 0x7a940df5843dfceb, 0x7f7ade483077f572, 0x5a104202fee63d43, 0x1cc7b619739cc116}, {0x0f4071f2249b4b, 0x11d3400b522c3e67, 0xe79ea3e3fde286a5, 0xae85c0908f4116bd}}, {{ 0x07766de6a824b3d6, 0xce16a1fe758e1565, 0x68067eaa86efaeaf, 0x1c7dd0bb7908155d}, {0xcb827f039772bca6, 0xc2cc5df7b76573a1, 0x33cb61d81df700d5, 0x20c2746e07aad1a3}}};

const digit_t p_cofactor_for_2f[NWORDS_P_COFACTOR_FOR_2F] = {0x90e0ba1ffe771625, 0xa09eebaf572395ba};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 128;
const uint16_t POWER_OF_2 = 126;
