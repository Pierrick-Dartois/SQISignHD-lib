#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include <gf_constants.h>

const fp2_t NQR_TABLE[20] = { {{ 0x535147a9a5387bab, 0xcc06ee0aebd27412, 0xdcf5c22aaeada67a, 0x19af44a8991daf56}, {0xb5429ad64207e929, 0x3cd350e28800b115, 0xad65b9fb9401d23d, 0x22e1a862a8871f5e}}, {{ 0xc7e13c13003f1f3, 0xa888568c77af4638, 0x8e1f93676fbac7bf, 0x15fdeec590ea588b}, {0x7442203cc99f600, 0x8466c175b7adcb45, 0xde6854705d2558be, 0x542b509eda1733cf}}, {{ 0x331f2c5e5b15bb6c, 0xaf42e2d9da5dddfe, 0x15adda22d77a562d, 0x214d81cdbda7eeff}, {0x16f74189c7d24eaf, 0x904b913faf998977, 0x1685a0b42d216c68, 0x12eae1f4008fc6f8}}, {{ 0xa50b98c74213697c, 0xab6c713c0c8cc8c2, 0x09db2e5505f2e429, 0x1059d2fe36641370}, {0x1f293228c184249b, 0x8a08e9825076aef6, 0xd2f829a09d8f8d6f, 0x11f63f8034d66d34}}, {{ 0xa6cf4b104934d417, 0x61aec991552d9fae, 0x4aeabeea42dbafe6, 0x2245c4aeeca469ca}, {0x13294272a36d5c2, 0x1711e1796818a02d, 0x0658598236c8413c, 0x4eacfe6b5cf2f7ea}}, {{ 0x3cd5461cbba5580, 0x944337bcd81f9dca, 0x95bdc319f617c55d, 0x948ac984c0aa729e}, {0x7be29d72f5d14bd, 0xfacbc6e72ebee645, 0xcc9410e2c97fc38d, 0xd618215f9d2c1c9e}}, {{ 0xd09d8ea68594be9, 0xd3fbbc89bae0f9b0, 0x72b5419a2d84a78e, 0xee2012ba424ddc7a}, {0x674bb1369ef0e564, 0x11744e2914a37e8f, 0xb4d16d15a8548fb1, 0x16ec4c75f45434e0}}, {{ 0xdaa551b4c874515, 0xa3dd9169ce1b73f3, 0x3186e2e07cce5114, 0x8b71a9d8916ec92f}, {0xda38d43f1be65f73, 0xc6f8de7e47a5fd69, 0xa5095351064714c4, 0x1a7300e09c4ebe5a}}, {{ 0x2af9ab12e90e0d27, 0x3cbe6ff6abb81c80, 0x5339f888f9a7715e, 0x11bf6e2ed7d9e410}, {0x329aff203aab424, 0xa33ecb613df1f684, 0x6ab4180392eb6db3, 0x674d5b4c66eb2f3b}}, {{ 0x4e823265fc6cd88, 0x74e7b4bf74a691bc, 0x6724865c21f352dc, 0x28117a86f7b6d523}, {0x5894f4660877ce3, 0xd2ef5bde2ae9d526, 0x939bcb2a24e2d8e4, 0x733a1c9932dc0586}}, {{ 0x96e49162dba9b0, 0x11d670b7612d0608, 0x0a242348d3716761, 0x43d7541f61d2f31c}, {0xc5ecd76c9b4a840, 0x0ccf97c0ad087ec9, 0x25d4198fda370efa, 0x8a41e4fe4e040b99}}, {{ 0x24df1ed28f6b10c, 0x2c1cc21b1cf3e10f, 0x5a2429e7ffa435f3, 0x5f28e07baa580fec}, {0xfba84f931255de8a, 0xa762be8873bcdf42, 0x3204fc23852d0594, 0x15286ec86de23eb0}}, {{ 0xd5582be776af03a, 0xa6ec3a1656d86bd3, 0x4e5b34e44ad1ad45, 0x9e993c10165c39b1}, {0xb899da214625969f, 0x1decb1b01a9ab1f2, 0x42096838085ccbba, 0x112d4c148b862cb3}}, {{ 0x32923a0839a4c804, 0x5828f08ac32b9a12, 0x3080a8f2158c3380, 0x27c03edc5ea35a9d}, {0x586e6471fcb8013, 0x5de678256afd8b9a, 0xb601c726f9ca592f, 0x20767d06fba9eaf0}}, {{ 0xcf4b15d3798683a3, 0xefe8d41d47d71b51, 0xe416933b6325835e, 0x1580cbb1796d1c75}, {0x41892eeee29c253, 0xae865df61949ea39, 0x01586b59a7cb3636, 0x471e5273af8e57ca}}, {{ 0x379de8014edb83d6, 0xc2b298165b3a3489, 0xb58ec34cf1ff8ec4, 0x1b272a850e54317c}, {0x2513c8083a8087ca, 0xa1d8315c7caa2e28, 0x1d0948cfcfe41647, 0x15a8f2affef856d7}}, {{ 0xc25a2562ed26de0, 0x89334a7e22c7eebb, 0xd84be91032e7b61e, 0x3dae6f14b47a4c46}, {0x872b6753f46972dd, 0xacf774ece23e381a, 0x29c2a476c34ce5dc, 0x25b6b09993c59c5a}}, {{ 0x84009e1d0bd2f22, 0x62e1a374d90c8188, 0xa053891a907c5544, 0x52ab23780d82e938}, {0xfc723e2918bf2ce3, 0x3f0cb539f948eb5f, 0x523abdc8f23febcf, 0x1eb0d135d269683e}}, {{ 0x3fe8f46e959a09b, 0xfcb18ff0ca1e886e, 0x966c6575c4b5faf8, 0xb01bd2120e87aa47}, {0xbde391d3dd05508, 0xb8c48fb4b90bd9c2, 0x20641c6835b0db16, 0x4bf0c1287c29946b}}, {{ 0x953c66d68a6682e2, 0x4444d39bde35560e, 0x801d8ff1bc1c70e3, 0x14536c75162d99f1}, {0x88635a6571bebca3, 0x27cb4b45528db99b, 0x6a8faba4254be13a, 0x1f88ad28d904ac38}}};
const fp2_t Z_NQR_TABLE[20] = { {{ 0xaa186ab4c87cd542, 0x535c44fea88966ee, 0x87743fddd0426086, 0x1a966c63707f0810}, {0x68f6b7d74b93617f, 0x35f9448183655780, 0x5625a90302a9017f, 0x245d05dc8aad7ba3}}, {{ 0x1a33b9927cddeb6, 0x33444cb75f07fc04, 0x2514228cc07d2227, 0x67156b0106437d61}, {0xffc28121617d3998, 0xf9909cd848d1d0e4, 0xb515a9896215378d, 0x259eeb37ee46f93b}}, {{ 0x6ab4dd88cf3e43f, 0x4ca1fb4e8efc18dc, 0x61a423acf3b39fe4, 0xc10ccdbb41192e4d}, {0x0de6930185503ee, 0x0aabc147b469e852, 0xdd74ee91a952f9bc, 0x1c825d4c62583c45}}, {{ 0xb7ea99ea16d962f3, 0xac49cb4e6a627b9f, 0xc8e97648043e384c, 0x26b0a7d6a856b3f5}, {0xf3da000e068b862, 0x8a64b5ee7b2c9904, 0xa77115aa822346eb, 0xac7931a0a813968e}}, {{ 0xba78f4b5105794, 0x0868aef3a2e718ba, 0xf87cc732b7991fa1, 0x82d6df74e533d452}, {0x20a195b10abe7878, 0x72a2f6ff86c45fa7, 0xd560c40979883657, 0x1b6d12c0c35927ec}}, {{ 0x8d43af18caf593c9, 0x1212e0a193cfbe3f, 0x6518270924fa7e80, 0x1df74c364754c9ab}, {0x01f1a2dc2536dc2, 0x85d45c45f3d8e42e, 0x9272f380a11ba797, 0x91cc8909aaedda15}}, {{ 0xaab1a03e55769d2a, 0x57fd8e89c0d5c775, 0x094e3dd17b4e6d6e, 0x1f8fbcad438b1f93}, {0x248fa6bb6783ba0a, 0xb15862e933dc64b2, 0xc444237ec339bbb9, 0x1b49f9094a4dc456}}, {{ 0xc2c145964d2bb04, 0xd4281982cc9da6ac, 0x1c588e9c700b5446, 0x580f77b60c3a92ab}, {0xbc2574e115d871b, 0xe04530e19d807572, 0x9e1d00a1a3814665, 0x3c962e71930211f4}}, {{ 0xdc02d7d33c5acd1, 0xc3484384a8b7a8cc, 0x4a4ed7952b086ee4, 0x132fed46b51faec2}, {0x38b1d50e3400b9f0, 0xba04780f490d0104, 0xe69d8022551971c7, 0x1e2f0ddaf0828e1d}}, {{ 0xc23f924607d1372f, 0x76853bd4520e47a3, 0xea931dd50b75bf02, 0x26e63c927346ce41}, {0x563835d3e3105447, 0x05adc9df32ca516d, 0x4c9cf5753fa8c258, 0x1fd7c164d9ca0412}}, {{ 0xd4232d114ffb9710, 0x16dfd0d14156818b, 0x1af7e5b976e9edab, 0x1347bc1334f84c29}, {0x31ce4c4388efd85f, 0xbe5e7cf702779ae8, 0xe03b722011d0a0d4, 0x2585e8b2b6573e72}}, {{ 0x81eb5a5444c07684, 0x5bcf3f1ac041887e, 0xe33ab2e98ee1b33e, 0x12da8404f53aa40b}, {0x6daaaed724662af5, 0x21d48e445eb204d7, 0x7e2393bac413057d, 0x1706c844528d5026}}, {{ 0x95f467ebc13dd9a, 0xfb0f2eca4b43195c, 0x834f7db646d87ee3, 0x3b868f4dc3f9acd4}, {0x37dde07ae65d6c5, 0xc709f8e0d36298e2, 0x6abb7a4315fa616b, 0xe3aa071362f76496}}, {{ 0xfd28b0ed3332a68, 0x64970bdb24676d0f, 0x0d638c43e9d4b506, 0x338c760c5d0f316c}, {0x0a9bd9fee573d85, 0x5539c8c63f5fa283, 0x9f9b713934861e3e, 0x659d069a4c8a1e07}}, {{ 0x106e26c2d858d90, 0x77c7ede8d0ca853e, 0x9263f30b7c62c696, 0x8e04aa466f12669d}, {0xa891a3ab817feab4, 0xae4c95122e51b4b1, 0x43459f97ac8875b5, 0x1399b6664d9911a4}}, {{ 0x71ed87641004273, 0xa9018d28c6bb8418, 0x1b383ff6889488c0, 0xd091997e073579d3}, {0xad1784151c750df3, 0x547423f63da53d0a, 0xb48e3eab1188c718, 0x14f6a1c69ab0d742}}, {{ 0xde9dc9ee6305e89f, 0xf1f4b7057dfe6ff2, 0xf79f3fdf45de29b6, 0x182b838337ef6a9f}, {0x64dbc57457ec7e0b, 0xe3f901677c236e43, 0x69ac96b79c6889a4, 0x12478082fad1786a}}, {{ 0x64c938dc97db60c6, 0xa8e166205a210d76, 0x2f52edcc63d32d88, 0x122c397a6b28fb79}, {0x2c0f436bf890e76e, 0xe0bae1d2ff11c521, 0xfbb9edd2c1fe31eb, 0x1d5d5f00c60dd02d}}, {{ 0x5dcb4f654ae8bfc, 0xa85889654bfb2a5d, 0xa1de3c96f6fb41ae, 0x21808d147e531174}, {0xcaa40dd0a4723725, 0x6cac719e5bdba027, 0xda6dc5777ee3de1b, 0x19fb6875de32768c}}, {{ 0x74ec3892780b5f2, 0xbfee8a22271a804f, 0x35bca94379428121, 0x8ecff01d8c41ce97}, {0x458ff083cc05d5ac, 0x93f299a077ae36b2, 0x9a9a9561c9ba1d55, 0x1d4981239d50f0dc}}};

const digit_t p_cofactor_for_2f[2] = {0x90e0ba1ffe771625, 0xa09eebaf572395ba};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 128;
const uint16_t POWER_OF_2 = 126;
