#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = {{{0x8b8438c0a3a120d7,0x4c30b09247aa9921,0xa5826eb01d2815e5,0xf452d16770b40dda,0xc0be1577d21e03fc,0x31979f80686b390}, {0x6dbf0ae3e5309d97,0xcc31d912f3726131,0x8269a17c8086bcff,0x901d2996985aa5f5,0xf02cdcfdc096b4af,0x19416f11c3e4a40}}, {{0xa6a0d4c4d29da4ae,0x6c78b9ad9043b8da,0xc3a2307e0ef1e9a5,0x38d9e56b37198db0,0xbb5e17867eadbfdf,0x2a2870ee511bfb2}, {0x9ecd2b89d4bbcd39,0xf6e713e8c13925e0,0xb6ce160fee0d4661,0x4a63882c4b70ec54,0x52f7e77fb2564a2f,0x10b6140c191d2e6}}, {{0x8fa45abe5114843b,0x8b820e8c6b19992d,0x1634cdf742a2a08b,0x4daddf398fc3f93a,0xadafecb685de033b,0x23327c3942eb446}, {0x394629be9df4296e,0x6ed88b1c90b50ce8,0x4ba88b14705dcc87,0x5538f78ab7abdd40,0x6f28300e16956da1,0x50b2e0d61cc756}}, {{0x945f29947e56d0d6,0x2778ae77553e91b5,0x33739f204f73cc3c,0xf5b8443285a407b3,0x7d8fa8e59876799e,0x2dc821cd70cd916}, {0xe33bf44afc483a16,0x50177cc96aff5607,0x7efb2fe52f3c17fe,0x9b7e11cab22ac7a6,0x8d92e63a66104aa3,0x5115bac9c6ff05}}, {{0x9e9548efb5089452,0xc2ba69c90c8d8a9,0xbb0c85e2d70db489,0x4bfc9989a47992fa,0x524bc8d646d1fcad,0x6c644e6c996590}, {0xa8f28b9a6ad06ac9,0xc118b292c047878a,0x8407dd96cc7686c9,0xbf586045a09e229,0x1d3153e8cf738ead,0x2f989d64c4e1169}}, {{0xd7835ba77c4b54f9,0xeb77e148e26347a3,0xff30af041211309,0x3549a43269b597b4,0x3eb03b7ec446b8cb,0x20dcc21b04fdfa9}, {0xefff162da3d683f1,0x8d58c28c65b8ecae,0x147e6e279239bf81,0x78a34060d54c77cb,0xfbaa7317cf5a503a,0x17169da17b4922c}}, {{0x85f8a22105de57dd,0x436d7fab525434a,0xc4811210d2b11cc8,0x66eb0043b4de09c,0x493d0abda7c8d586,0x32fed42c5ed5cc4}, {0xf431037b374feb3,0x6ed581361d407854,0xa00003e2cecebd71,0x30b3e3323ad5a98b,0x48ba14eabfdd7adf,0x2e4d41399bb46d3}}, {{0xd25ec3e423b09830,0x82ab0dac0602b3d,0xdc706d5bf4c6247d,0xa295bf819b8f6185,0xcf6d5b95f7af4628,0x455b4ff66fee76}, {0x68abd82a5f73795e,0xadbe13984fd9109d,0x335db4f54aeb1861,0xdd5fbb89abfd91ff,0x71f8bd31d90c7dd5,0x148144f4ae187cf}}, {{0xadf1266d65a521e0,0xa051c082d5ca511,0xec0dd4806200f9f7,0x19e5d9e30b0d472d,0x71e473bf746eae6b,0x24c98322dcf743e}, {0x8a26324f4df508ae,0x257483377dccd33f,0xeb3cc3caf1f1246a,0xd6d191de9afba47c,0x879efccc5ea6ee16,0x1e02e170c7ef5ce}}, {{0xc03a56ca4696b4a2,0xd50e3ec7a9f4662e,0x51bfcbfa6fecb99,0x20f8a60be3ee3d91,0x2e6b65ea31de059d,0x399d6232102aca0}, {0xe5b470b286d42286,0x98d3b51c007ee02e,0xa58fc52c0ff464be,0xa9a6b4820a6f1c26,0x7392278dbe7a149f,0x1bd305095c73afd}}, {{0xe6ac31c6c37813ed,0xcc787620e1bfef76,0x7c0cd2d4b90285b,0xf79d8a440909172f,0x18e96aaecee9e542,0x1758fd9af572b99}, {0x8ee281990dc6c57b,0x8ee94d5b5717ff18,0xf24a79c292184449,0x1e62e551ff8233a9,0xa77b1f457784409f,0x1d01976ec42d705}}, {{0xd026d090fbdbd9ca,0xa3d92130a364a503,0xcbaf5265f75c6568,0x8d85d3fd8aa2ca3f,0x3f209ba411ad7600,0x1651f1fc53ee6a3}, {0x7d2bd7499c20497d,0xf07223de2c9a0341,0x205ce67875649c3,0xd26a7e747edcf7a3,0xc76b23f89c816d1,0xf15c4e6ff9d36b}}, {{0x1b12f25433341429,0x9f8c3b1ac179d7ec,0x53595bc9c2118080,0xff8ce7fd6f0dd418,0x45859f32c2cdf99f,0x2d999d21baf0213}, {0x43a66235c6ac1c88,0xd489e1b4a5853701,0xeeb595a938cbae7f,0x54c1e1388e9595a4,0xd2717d9bfa28fb99,0x3dd4a605cd3c145}}, {{0xf4a4f6f23ffc9199,0x71350f265af86234,0xcf30e8ff44a1b643,0xc537ac42430ed055,0x25ce14858ce0e82c,0x62d42930d8341b}, {0xdcae03d508e7cf8d,0x35c682fc32955a27,0x22d3d22c03dd5c9d,0xba75074670e223eb,0x984d6bc6f26f8790,0x120c31bb90b0807}}, {{0xfdcd7be0257fbd7b,0x73fcc169607b1f49,0x1d92f0f50cadc465,0xdc580a8f36ccb568,0x4150807a86c31439,0x1c183fdc738f337}, {0x342078c2ca84f47b,0x4db0a79aeaa89800,0x2b64776ee782756b,0xbc73a18b327f7465,0xdbe23b61b51c291f,0x3b3d4e7308b8e71}}, {{0x9dc148dd23cb3319,0x4db7bad20fb7f1fd,0x41634a6de3309fe7,0x8eca161f3b4b9b64,0x80cf01f929d18512,0x1579cf9b93eb393}, {0xb123d0a577887686,0x808051391f9c0a39,0xb64bad5f2a1cd085,0x31fd6d6f5ac62029,0xfe3397158e88fe52,0x327a1cff9a180d1}}, {{0x1ce9b9e990cb62f4,0x8241d94737095b7f,0xfa1d7502d7a4bef5,0xbae6bb3cb1d3605,0xeb26e1be59e846cb,0x19c53f837aaaea9}, {0x2029cd8d625867,0xffa49422c0f1ef89,0x300d91eec2c13930,0x677f701edf590720,0x236f1a9140de69bf,0x30f68ea4ff6263d}}, {{0xf845e10becee5799,0x5e3a82bff7b2de4e,0x65bffa629e9b61e2,0x5943a06d7ae419ee,0xae6d3758431909b6,0xb2f9e13ba48d48}, {0x7d2234e7ff9e40df,0xe55f6d281fbfbe9f,0xa8a3d85f8b982854,0x78467f9e2bc50292,0x728670df310ee46e,0x28f3929337f0091}}, {{0x553e23cf5c5b8f49,0x7962bc4d32313a0a,0x6691d6a227181d03,0xaf4dc3f9fd26fbcc,0xea119a0c185d8b1d,0x1f555a18a2e0acc}, {0xd80ea167d4be833a,0x4c1c05a1d1038b40,0x480c7bd015dfabb6,0xc6b0e63baa1f7c1f,0xa02e54cd651f16e1,0xb434ef1e101b32}}, {{0xd2e65c903dbff96d,0xc90bb445aeab8a70,0x48d056c53147cefb,0x1d9b9a1d04db3e79,0x79cccb9567de3daa,0xea6d52ee970751}, {0x5bda967b5ac9bc2f,0x23b0c1a4d6bd9fbf,0x6f1de2ae2d8382f3,0x370f3d8fb8bf4e51,0x519728c88e33e4ad,0x3d5e9ee39302e2f}}};
const fp2_t Z_NQR_TABLE[20] = {{{0xbd5ca119dfc97a4,0xd430383ff1a59484,0xa3d27df52ef37252,0xcf92c38e02c19837,0x2dcfd5611c3dd6ef,0x26c05ace9a9cc4e}, {0x2a3c1d247c5cc067,0x46beb6696d761624,0x7201deb49b2384d0,0x348007726a0bf979,0x41e6eb84111810ce,0x3629836674c06fb}}, {{0x6019d89bd67b1bc2,0xfb13fff06526f5b9,0xbeec2e2a7c3ab037,0xe5efe70928c3cc,0x6fd98682a246af7c,0x259a75e5cbe9198}, {0x94f0870591ad89d9,0x1823c2a34aca54e8,0x187380cd124c380e,0xc1f72c2c02ddcf89,0xc925d959f48c7b14,0x17ccd4d8cbf4d5d}}, {{0xea8f91912a024ad4,0xf52f32a4b098e393,0xf8aa938136711e4c,0x32ddfa10983cf52,0xbce32bfc738e5b06,0x1d291601d5392f3}, {0xc208e03c83c9bcdc,0x37612e0dee1b5e01,0xf4e12c66359753fd,0xbac41196520b7ced,0x18fbdbf4542434a8,0xf21561c300ed8f}}, {{0x82f70d6dcaf0bdac,0x78ddc17e8f971439,0x713d1411aee64809,0xeb7c43f2a9dc5adc,0x5b7c771eae0fb35b,0x165b5e39c1a82e7}, {0x2cde3759ee88cf31,0x8942186954306626,0x263b9f69e66ee792,0x2286fff601221c7,0x78ce0ae46e8f7633,0x199da8a9d68a24f}}, {{0x6ad639d219bce1cf,0x5fbd930de91c2d54,0x5fdc71a8b937eb51,0x4d58c9751719e6be,0x808ca461921117c8,0x20ab366cd078ea2}, {0xc0c44106ef6cb91,0x71a54762a2923d8b,0x91edb8ddc0edc36b,0x51c31d52a2577483,0xce153b38c4b52b04,0x169e066cd86c2d9}}, {{0xc39fb98122cf55c7,0x4bbcd7392171ee60,0xde2a0b80c81f4a28,0x357ee3efc794be22,0xb85f8d3dbc5a8c14,0xa8e8c94f758139}, {0xe1ad1b2c3f48b59b,0xe9bcd9075af36378,0x8e490da6f38e1032,0x111f4eed2e3365bf,0x562957b0532925ae,0x32ad2170f9e2450}}, {{0x65944b09cc19da4e,0x7b3d792043dbe0fc,0x2202361528bba1b1,0x9af7088dcb086553,0xdff1c396082f7a30,0x22a9f185bff8afc}, {0x7b885243d28e020d,0x54b676216ab07239,0xeab7fd5c5325babf,0xc1762132a8196aec,0x67be178de16e021a,0x39b72eeaf4adeff}}, {{0xdc5e39891247ab6,0x1faa95f1478e6ced,0x843d8a7b04071d70,0xe7475c6d50c14f81,0xef2b89bb8c45c310,0x2613de90fc458ea}, {0x88b7e1455570e616,0xa09878d8e551e08b,0x7b06f17420aea874,0x2aa70dd8a18f5dc8,0x3bb3bbc945e29775,0xbd73250e04cdac}}, {{0x42e32f6c3ce58636,0x99b2156bc64d7247,0xfae663dd84c5aaf1,0x4445795b6554798d,0x4b18ce1907629b0c,0x1a8fedb01082a68}, {0xb94b27e045d9339a,0x148eec07baba7860,0x57c759b10e8349cf,0xba522fdedc5e614b,0x246c47ec213b3eea,0x36df1209824ca62}}, {{0x7bc183909743bcab,0xfa6770652068bd42,0xb980f8b20f2dba38,0x97fc9ac8e6d98689,0x2f0296c5c3cb7bd3,0x1b0e2cfa6df9254}, {0x5b5f1109865db188,0xd5c2a02e36858796,0x6ee8be2326478dc6,0x23da637981b7fe22,0xf3fc88b21b099ad5,0x3b80b3f5badf4d}}, {{0x9a81b03c61a11733,0xaef1f2b761972302,0xd4055a6006c19c28,0x3b6cc0cc453b256b,0x25d57ef5e202467f,0x38c944f82d63832}, {0x16518e5fea2e704a,0xe4c4401c6b208ffb,0xe63fdb1d537c481,0x48dc5e131c97280d,0x6e0f30ed0278bafb,0x2dbb5d8471d7a51}}, {{0x544c92f17596ebd9,0xebead6d8a083754,0xce2aa84c5ade107c,0xc0318f68d0370b08,0xb4ccc8e22fe2d87,0x376cf1775f0d047}, {0x228e8cae5f02972c,0x1f4a0591c0f093be,0x3f69c0e2914f0519,0x32172335c944bf69,0x8338cc00a4952cc4,0x3af404db40e94f}}, {{0xbce9a526a23babcf,0x1427ca404afba5a9,0x49f7f519030d6bdc,0x435b2f3e1935a09c,0xfa89e8c48dd64a05,0x22d7964bd32f296}, {0xcfd7be6468156925,0x89aa5140c0f7443c,0xc25c24ff92a49d77,0x9bd31663daa619bf,0x30acc30ffcfcaffd,0x23e4f5048e56229}}, {{0x10b3c5ef758f74f3,0xfaac2eae6cae6f49,0xe06c4a8c159630cc,0xa4069e28ee5d9eea,0x51cf9c053842f920,0x3598a7dfb823cad}, {0x8d26ebde3e47d8b2,0x1fe86d780bc46351,0x89df5b5b687e156a,0xb9e44195237c5d24,0xf5b0d8e8604ec928,0x23bd0edb32154b6}}, {{0x4b1caf58a29b21a3,0xea5677e21e6258e7,0xe85174996f2438f9,0xb05a883205851025,0xc3a71208d3a56ab,0x98755d707ffad2}, {0xf66852c9ab805e7,0x108811dbee515a9a,0x7b850e72bf70d4e5,0xe05ab4bf1331f6d1,0x472d810615593bef,0x171c08d475a841d}}, {{0xe2e7476faa9b2c9d,0x89967c5bbebddfbb,0xcd13201219c77d85,0xfca46f01049deaf9,0xa456a317327ad1ec,0x2b880bf5f69c095}, {0x6bf5c64f0cad5de1,0x90b158ee5f4e1707,0x33b9a2a9ea6338c4,0x5bc0fbfbf034941e,0xb3544e9ac3b4e90c,0x30348c75f24bd6d}}, {{0x465893cb42f87ff7,0x2fbe50ac231dd5ce,0x43851ae6e1931dcd,0x1491d3056fa995d2,0xb0695bf67264cf89,0x26b408f61889fcd}, {0xc28b4681213b417f,0xeb3df9d210b1c878,0x8a671abf02682756,0x350bcff7fc7e39d7,0xe56c584b11d30774,0x30d8738206baf7f}}, {{0x96928112cb11eda,0x2cf681ed5989f2fd,0xbbd60a757bb15925,0x3ae9081124255c4a,0xab0ebdd127954154,0x1fe3d54e6e6d40e}, {0xd0bc8e2d067e9635,0x819ab80c0165c716,0xa5a2a43238bfc575,0x1b444f402b989383,0x6902a93be1278e89,0x35b3d74e53bf659}}, {{0x9e99066a9cff83f0,0x11e6a0577ca2d932,0x471b47e9d53268f3,0xdb1fb8d9bd56485b,0x18e74852589c53e0,0x202df9e7124a06}, {0xc5351b8281311d8,0x53cb8acbd28c5a32,0x601c92868083f3a2,0xa605c2d11799c6fa,0x34db79a690686907,0xcfe292bed061db}}, {{0x73c42cd40f93b530,0x253f2a321e5ede02,0x585779c8ee878aff,0x6153c1e6eeab98c3,0x49796fa6fc2d45cf,0x13b3446c0db467e}, {0x19c12638578f8101,0xf577061509c32c5e,0x2aecba094764ece6,0xeec5365a2e80e01,0x89f67c8179122d8c,0x224297d4e91f29a}}};

const digit_t p_cofactor_for_2f[3] = {0x43a8ffa868fe0799, 0xf2daca7934d6edbe, 0x824a11449f8c987};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 188;
const uint16_t POWER_OF_2 = 191;
