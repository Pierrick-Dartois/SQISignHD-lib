#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>

const fp2_t NQR_TABLE[20] = { {{ 0xce547ae1b535caf, 0x762e0b992bc56104, 0x56e9768d700ce59e, 0x576ed1a4c2992294, 0xe6bec876ad7691eb, 0x2ba1783095983dfc}, {0xfef10a66685acad, 0x48029524d281805a, 0x3b9e0a961412daff, 0x8cbb144fa1b1d408, 0x9ef990a59582f410, 0x368ae9c00cdb8856}}, {{ 0x1f8845d5d6cf5f3, 0x48282cc3310ba4ff, 0xe95afb7e3fc089f7, 0xe35cb59196962a31, 0x8ae99457d372bc9e, 0x10447d0bb3b180f8}, {0x90b65f32e6aa3e3, 0x8d104f161b9d4bcc, 0xecd2cccf07cae2a6, 0xd9b9e3417c010353, 0x1d423c91674f8f6f, 0x1a7156ada579419d}}, {{ 0xf55cef638f517b, 0xe80531eb6a506c79, 0xbfe9197cd05a3acc, 0x1f5b4a2186c98e7b, 0xd3dde43f613776c4, 0xc2ed9509794ea166}, {0xf2a37349efd87c4, 0xd41c27b103334672, 0x3311ac572f46bfae, 0x982273f4d7f29592, 0xf15f329555a5b7f3, 0x1a5b3cd967933b79}}, {{ 0x1a3f3afb88d7e75, 0x22137cac7b327bf3, 0xc349884f0d266550, 0x2d3fc2d35de0b328, 0x230c797f50fcf45b, 0x34d2b944bf5574c0}, {0xa2b98854d5c2e89, 0x02d2f617819423e4, 0x4bc8e9158455964c, 0xaf0cea20d4c31ef6, 0x20b67e0afc8685e4, 0x28204adfa4940d0b}}, {{ 0x0ecb6a574bdfed8, 0x1899f1dd6846c9c0, 0xf7dc352ad241b96d, 0x3c04e6e007447bec, 0x252dc641a8b078fa, 0x2ccf21f4ab57e608}, {0x80cea1391db043f, 0x41181d391a03aa7f, 0xbb381922f86f291a, 0xd20070a3e25e857d, 0xb178d1bbe2a4e421, 0x2dd6038e5eebe704}}, {{ 0x955fb7fad1c76b8, 0x47a8670bbdcb5fbf, 0xe4f3f22f4fc8a485, 0xe990e49e6438479e, 0xd81801ef6733772b, 0x2972526a904b70ec}, {0xc39d9dc5205322, 0x339e61188ca4869f, 0x601c604ccd224dff, 0x11ed669337dc5c55, 0xca26a0734b00d755, 0x9dce6b7d983ae40a}}, {{ 0x1d53c06a12fa2c5, 0x5d6237873dcbd58c, 0x1268d896c5c763df, 0x7f96880e2c57b22b, 0xa422439a6a0c93ed, 0x10de09507e153369}, {0xf3f9b7d1d5454c, 0x3b9bb0b50af77531, 0xd2f9d99b196869bb, 0x88757b3087482880, 0x55559428f1b73391, 0x55cab2a3d5a03039}}, {{ 0x58bbaea0d7f9e13, 0xa2f44b57175d27cb, 0xe7deac46feec41d0, 0xa254e5894a33d7b3, 0x81a900549a573634, 0x1fbdfe67560a87fc}, {0xb4ed0273a91bd70, 0x74ef819d73764fd0, 0x740964980540233d, 0xc356657a16dec51d, 0x63435439885ffad9, 0x40749cbd2d821eb7}}, {{ 0xd308384493b57fc, 0x9de9cca629b19d6f, 0xb36c79b075ac6732, 0xa77422ad27f2e081, 0x5fe920040d3bff3c, 0x40e9664fc09f8b64}, {0xe0cccee8c59cbd, 0x32828bf087c788b3, 0xa10f5c623f95df9a, 0xe10c94247e1d4bf2, 0xbb4ad5628c0ade72, 0xeab83ca849647d89}}, {{ 0xef8b455f3239a3, 0xc0e2349ebd5fefd7, 0x001823daef1576f0, 0x6a8fb80bc056c84f, 0xb259d85fef52fa04, 0xd76f18093ca8b38d}, {0x2d5a174754a0dc5, 0x127ebb85400b15b6, 0x1ca6a8b05902cb6b, 0xd4148bab4df629c0, 0xb93ba3ca8d89753b, 0x271d92fcb732bc45}}, {{ 0x592e44362e5fadd, 0x57e51806b47b484e, 0x7ea44786880d10a2, 0x9767af0342bae2e3, 0xb09b70c8fffc6533, 0x406f79615c9ac1cb}, {0xad852feb73c8ee0, 0xb960bc19afb77305, 0x0b162f330065a389, 0x814f9a46d4699f3e, 0xe1ebf9a60e0da357, 0x1df5452008d2af8c}}, {{ 0x91578d87e3f81f, 0xc7e4eef19f3bbbe1, 0xb939ce636120fc55, 0x5d68e0a94aa84d06, 0x0b0ffe808acbd9b7, 0x7bccdda1e683a95e}, {0xba6d0a2d27a6dc7, 0x7c0f7b18c642055d, 0xf96681aac7ff4b06, 0x5c1671b5e0b3552d, 0x75b70944b8e70c10, 0x20fa991a4ddf1b42}}, {{ 0xe7b9859b94c2a90, 0x0b8b18241b7e12ea, 0x60307480096430db, 0x2feae1faa072275d, 0x72b66eb99be3feac, 0x1ac7ce1ba3f5d12b}, {0x46fcc7ef935381a, 0x59c8b6fa5928f7ed, 0xbd2565a770209f08, 0xe3f980a4a216b93c, 0xb678251d72c027cd, 0x3ce2f5dcb1cf64a4}}, {{ 0x7a4f7684068d955, 0xbd864924bf50dcb6, 0x7422f29c5eca7389, 0xd87d624a20629d7c, 0xc14e41c519fc37ca, 0x28d3885ebb26a8df}, {0xa918854c0cc35cf, 0x7de6987c4dd9f700, 0x26ddd84da8f91537, 0x75b44e026d09d3ee, 0x0e5c0249596a0551, 0x16af79ed9a6e74b3}}, {{ 0xd5707b3ddb4fc3, 0x0feb3e6ba2dfc09e, 0x540e8b835ad3dd34, 0xdf20da2d97fad389, 0x097127062c5ec23c, 0x4bfe38682034efb0}, {0x9b419a08b875817, 0x770df1e3a7a97385, 0x4663d4b040af9586, 0xa40ab9120f15f477, 0x18a36abf6c6dbfe9, 0x1302abe3004c7123}}, {{ 0x50fd0b7c688e219, 0xe05408045f4aa617, 0x7e69a8c1a57e4774, 0xa82dc980710879d2, 0x822e1637eb0203fe, 0x37ff1430207dec29}, {0x86e0e6dd5564da0, 0x7a985f81a10beb5b, 0xcefaf1e144f85571, 0xe34c34bb87a0260e, 0xf62d971d7a81be8e, 0x18471f02930df06a}}, {{ 0x199299bc43767c1, 0xb364374c011e7fe5, 0x6d182cd88fd1cf92, 0x37abfcaeebda4acb, 0x6cb6c79f0def0e23, 0x1b21ee32cbf33157}, {0xcb4fba92e5adf, 0x341ac1077515f3a1, 0x73b69d155a0a2e7e, 0x96a3651a3f5d33fd, 0x453b98a19eed1ad4, 0x766d7188dd3db1c2}}, {{ 0xd007022613a7e7b, 0xa38d340a03d1eac3, 0x4321d5dc35b9b70a, 0x5cd62c0b3e401a80, 0x87a519e104f80e35, 0x16c5763705765c08}, {0x290215286cb151c, 0x36ecb644126a77a2, 0xa33c6642f6fdc233, 0x643eef44a572e1d6, 0x35724c639b78cfc5, 0x2723ff6835005900}}, {{ 0x08a0ac5e6022f88, 0x8c90678e87be2c6a, 0x64cbf08ea8212d25, 0x3ee7f626af7738f2, 0x730363c9bad499c3, 0x37eed05bb6d13048}, {0xe8142a3161899ed, 0xdda821e572417daf, 0xb99735ad1a0add28, 0x495c840ddc492035, 0xe93ff85f6147d1ef, 0x15ed7501a0ae2f03}}, {{ 0xbcdec59b7de04ff, 0xa20a038f257bdf6a, 0x53920177d7620228, 0x52b4534854778107, 0xaae93310b543ca01, 0x218f1515e23097dc}, {0xe89503bf73634e, 0x205003e70d0fa999, 0x364a527bbb367116, 0x76225d30c849b6b4, 0x3325f169e805537b, 0x30d8a7989cb8842d}}};
const fp2_t Z_NQR_TABLE[20] = { {{ 0x726857020dcee63, 0x281f19c4985710d4, 0x175f79f4d9e12aea, 0x22050070124ff8fc, 0xec1ecc455b57b69c, 0x35343e178acc5909}, {0x77a106f15f3d17, 0xd894a847f802b949, 0x3788151218901a0b, 0x38af83e2fb1131df, 0x2bd0837e6b59bd6f, 0x23ea8e8f78378ca8}}, {{ 0x5999c7cf5ad56d3, 0xcde9dd7c6c5d1193, 0xd5b3266a0985a044, 0xbdfe756c3ffbf8d2, 0x9748193daee97eab, 0x1e3626b03d69e522}, {0x67fdae03487b757, 0x84dd590bd74b8c9c, 0xb5e65abdf02fca8d, 0xa338bb9488202210, 0xc0d4127528d8cbba, 0x3767fa92f115ddc5}}, {{ 0xdb345a1c38c175, 0x67447e7bca5c498b, 0xe8d3ed2d4569eec5, 0xfbce3e70d8be5cb6, 0x65f587796fd6560e, 0x1d29437f8b6a23ef}, {0xb70f69eb9b97325, 0x2dd51ae23470d8ca, 0xb0de6da4110ed04d, 0xc6e4093fba5f69cd, 0xa1b8fa637d750fca, 0x250b3c3e8b01a06f}}, {{ 0x3875ba05daa31d3, 0x0c97df4693a47d7d, 0x7c43551aa0dcd9b2, 0x9386bc13f425b8fd, 0xe08c7488211227b9, 0x240228e03ad9f19a}, {0x8c89a825085ab, 0x3e31ef5278b1817f, 0x96fca9b5622cf577, 0xea2519df318918c6, 0xa2d91a699eee792a, 0xad39c3f1eaf6b0da}}, {{ 0xb3a1bfc6aac9df, 0x4d9e50e19be5d67d, 0x8d65ee24b07d25a5, 0xce9c96374957be54, 0xa0485bae6b46513c, 0xf3ef2931cf0805bd}, {0x85e015018ea6a1, 0xb82e123ccba705b2, 0xf4be72a57375b9e8, 0x1acc540a33b50549, 0xb0a92051bc76dbf1, 0xcf1af1b3e8e81e33}}, {{ 0xb633d5f0259e63, 0x863aa06fa467dc80, 0x58a3c9450a10189b, 0x98970f9cd56f0cfc, 0x7285e38ebfe8ca43, 0xdc6663e2a7146eee}, {0xf90015ff8d9c44c, 0x2fe2c2ec289fdc2b, 0xc96dfa7081106689, 0xe4fc6cd42ebecb6c, 0xca404180d420da57, 0x356e31e726d16b0e}}, {{ 0x7660e2f585361b, 0xac038a6607d9ac20, 0xdddb1a682c58772f, 0x33a78ea75775c0fd, 0x1ec022b52b6593b6, 0x74374fc225e33cc8}, {0x54359c6de39c2b5, 0xfe7d2a2897111b5d, 0x4f6e1366afc2202c, 0xba8d715a07274670, 0xe3f50191756d8003, 0x247fb88432c9f090}}, {{ 0x9f0a521b81b7ad3, 0x56bd807edfb40b4b, 0xed2d9a28a82a5f96, 0xe8e61e6215664820, 0x68e50633a0dd6b68, 0x35218a12a37d86f2}, {0x7bb79b5a776b1c5, 0xb38d92c2d7fac335, 0x6806d8f2a196dc25, 0x54c39a218075d8c1, 0x6b496f5206280890, 0x2e611dbb6b591482}}, {{ 0x5dd3048b61b0262, 0x671a8c54ea504a43, 0x893e1e8f40d855ed, 0x7c58cef8c95eb90a, 0xf4a6bd9cdb5b11c8, 0x171bc51606e9f76c}, {0x0e479636426e69, 0x5b04771498ac1795, 0xceb148910d11c853, 0x2d17ff3463043865, 0xb40d140bdd75e7b5, 0x9726e6afa523cebe}}, {{ 0xc5f74a7ae3ca434, 0xc5f3191b2221bb48, 0xa789770431171c3b, 0x2e4aa9d3157d7c37, 0xad9768b7fe4fa9aa, 0x1fb0e61b89eb9554}, {0x2ab9e786ce58b9e, 0xc473422171e441f6, 0x8ae726ccfd71b1e8, 0x1c9f6a44ac8df74b, 0x4b5931b86d7dca90, 0x2efe0578d7c4cbb9}}, {{ 0x817ea085d92e5f, 0x526a8ec44b23618c, 0x42e8464298716516, 0x3b2d7ea876700b3e, 0x460430fc03cd8a1d, 0xfe3cf25f768ebd15}, {0xb521d3fba64e3ca, 0x8518c93a889d237d, 0xbe231b95015cb060, 0xf5097d4c8e097c2e, 0xc7410fe9ddea6559, 0x1501c847367dbe9f}}, {{ 0x45ebad04f6df53c, 0x86495db28134c5aa, 0xa6daf418b1635053, 0xe15e77c6df5ce826, 0x491320550626bb21, 0x37e7d242961f2670}, {0x68e02e237f3892f, 0xd13b6e89dc1018fe, 0xe51ac41ca614ba7f, 0x1d692aa5888a2052, 0xa040d07cdb2c4f87, 0x23736a3555bd98c1}}, {{ 0x4fa8a2b672ddbdd, 0x5fd36fd37a71d939, 0x789ce9fc57254ae3, 0xea49008056d1ce54, 0x3145a3dc314a39aa, 0x1a582295b4a7676c}, {0x0bbde77367518f3, 0x3b7fd3240399d25c, 0x7cdf28bf0a82bad7, 0x898d97d66b04ba04, 0x55a0645e66b5e6d1, 0x38d6a00e77fcc0db}}, {{ 0xd7af911d502029c, 0x5d8d8f5c4f85bbc7, 0x49449f2a0deab236, 0xca2e77da6506252d, 0x806d97d54bf642c4, 0x2c1a83cf03f24aed}, {0x5061aa080b8abc1, 0x01e04f9ed65263c0, 0xeeca43391cebd30e, 0xdd1c6e8b08b508ae, 0xa5e610cdf004274a, 0x3c97096d4ca7771c}}, {{ 0x8e5e2d48e0cce6a, 0x04b5fbf94ebf4333, 0xe4711eeb483522c9, 0x855577ef744e41d7, 0x2eecfe46254362fa, 0x3de520fde431f40f}, {0x60ea7ab7990413f, 0x877fed8cf4e3d9ff, 0xea80bbff383ebae9, 0xfe1228fc471a08bb, 0xb6b8c7c5044538e0, 0x138f049c3da4c33c}}, {{ 0xb1ca91c2bcf0619, 0x511bf4be594bb147, 0xc7bcad357b38fc02, 0x901d8cd3dfbd381f, 0xb404772779734481, 0x2dbfd6d683cd6234}, {0xeb19510e6268df3, 0xe5eb588f7f0ae337, 0x20867828477f0664, 0x568952eb1f225ac1, 0x11a0cd1ae7017f2d, 0x31259cfcf47e262e}}, {{ 0xe950fbdf156d6d, 0x77bb262cbfad8993, 0x68223943295b3c3b, 0x221f2303597e4da0, 0x3287ce43f1c80185, 0xe25048c4a2c7c30e}, {0x5010701993d735b, 0xdab3aced5ebff670, 0x20f68b0f8b63f53c, 0x44d07c30232bba08, 0x3c98a5248458f0f7, 0x1f16f07dbb57ac91}}, {{ 0xb2bf9e4071ce6cd, 0xfddca232fa30decb, 0x7350007ac71f00ee, 0xd7e874e7854bf8c3, 0x2a0bbe931167f126, 0x3f09fd5447b8d1d4}, {0x55b8511151aa95b, 0x64a092e3b3ab249e, 0xa4de688589d2583c, 0xaffdb21e9f3d9559, 0x0f691043156edf8b, 0x17950c8e729f338e}}, {{ 0x954ac4e8828b2f, 0x302f8035fbd1376b, 0x715690c056b38ee8, 0x2d1cdb2fa005d4e4, 0xb32ba4ee1690ac98, 0xc9c433ac58244a5c}, {0xcd0d294dc8b633a, 0x7776824f860bbf07, 0xd5ff6b63d267dbbe, 0x6aae5bab6d438380, 0x4f07e622e044e886, 0x3f8768f9db6fb2cd}}, {{ 0x4f68a1b81f0088f, 0xac454f57a1384b59, 0xf2d4b4fbb5a5ce0c, 0x7bc4045a410e4ea4, 0xba3a2847ada1657f, 0x3fe71bdf3af6fbb7}, {0x19311080e4c7b40, 0xbea06fac440d17f0, 0x30d59011efb14b67, 0xabe53f98871b2237, 0xbeb40f94a7ac498f, 0x20b28af15be4a7cc}}};

const digit_t p_cofactor_for_2f[NWORDS_FIELD] = {0x0, 0x0, 0x0, 0x3a8ffa868fe0799, 0x2daca7934d6edbe4, 0x824a11449f8c987f};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 188;
const uint16_t POWER_OF_2 = 191;
