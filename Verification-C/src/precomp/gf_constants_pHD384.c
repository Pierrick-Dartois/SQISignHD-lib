#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = {{{0xabb6d30dde54472d,0xdcd5ca93237de615,0x73fedfa714ba49d9,0x373823e4be33dca3,0x27ce6536e9f45280,0xe4487bf99f4fe}, {0xfe75df87885846ea,0x9b7f5ad49e0ab660,0xe14a906e904e99f,0x67cde894dec43de0,0x1e04ff687450f3c4,0x2fec44926555fc7}}, {{0x1dd0e6c42e75917e,0x500611719d61d8d4,0xb03cd455045b76aa,0x8374fdbdd3795483,0xc9524b77ce391da7,0x16711ed9b9940ea}, {0x3542f5384cf23d77,0x851943a595b2e497,0x5bd009be0cc73e60,0x93d29b2d55c33c3a,0xd793cc288d3097e6,0x33af8ad262b3b79}}, {{0xc4f47e446df7018,0x6b16ec01e3af0688,0xe9e5676395498ac4,0xbb850b6cb050b2f,0xf109d19ba5c11868,0x2c2d6ca6248f3f5}, {0xf00442b5acfbfee7,0xc55e47159a808e4d,0x9c0e44fabf9626fb,0x947f9a76adfe11e1,0x84b4791300830b76,0xab7191c22582b9}}, {{0xc9bd530c8f31089b,0x861f5f0f4c66c36,0xe08471d771256804,0x861c2affdbbfdcd4,0x24c3d43cac1939c5,0x1948bbdf7558d64}, {0x5f4891f6d301a5d7,0xc15aa717969f8474,0xbc7f3db963092a7d,0xa26f71d9e7d9d3e2,0xd70a423c0cd3c8a9,0x13e1eefb07ea613}}, {{0x17e7d4a7d14e68a1,0x12eea55a81c29cec,0x4f655df678541d7,0x8cd9209428a3e322,0xd3f0c9739ebe4386,0xd7aaa9937bc013}, {0x202f0266a0430bb8,0xc60712e6789be958,0xdf25963e4c00513b,0x7c69aa9aa4a021e1,0xcf6609c2f261408b,0x59c909591aabc9}}, {{0xd6af420f758ff78d,0x3390fb422fed2793,0xb7ac131ef0e0656b,0xaa2a7093ad275ce5,0xaea2a3dede61eb1a,0x2f931d5307d0efa}, {0x23e70935ec94f08d,0x9bee0e9d86eb8999,0x46da54b9aa60b6b8,0xdb98b5fe96e2b1a5,0xb8a53f9b0890be10,0x203cc6a22e8fd8c}}, {{0x380d2b52aa1aa206,0x95b62bc050c3b5f2,0x93a44cf6c8b21d48,0xf69f7963dd5b0bbf,0x5405b308e4d4d09b,0x24e868c1760e252}, {0x3580178e8760d45f,0xcd0b1c773446475d,0x1ed02366b9a10235,0x6fe21eaed89365b8,0x73e5e4f86f6b6ae3,0x359d144ad0dce93}}, {{0xe2b9b26279eeb8d2,0xbf9a54f7174bca90,0x8badc94b2ec53059,0xeafdb6c20db6942e,0xbadff1d22b30c453,0x2394d07f4c6c2ab}, {0x53ad6ef23d546cc2,0xda44ab86ca192638,0x9b4f3a4fca6ecf65,0xc55a11beb050de23,0x6be3fd55a9eee94b,0x3068044395b6952}}, {{0xf22b689695b806b8,0x83d473821fd35f8,0xbc1c0e76356cba23,0x36dd976383107de3,0xb69303b9d0912918,0x2ab1317eb7efd8c}, {0x480c57efc35015cc,0xdf5db2a613f78909,0xb93fc15d4e46a65a,0x56c4c9211aa6f930,0xad0ee5f8033b7e4c,0x37bb4234eb339b3}}, {{0xe1cc8fad6620d2bc,0x7f7c3d29e94250b9,0xf67ccde2132635c,0xf7df9f6864fdce5c,0x2144ba5e10e5b280,0x3ed7e595731810}, {0x9e24f03470f54fc7,0xd4d291bfa12a649a,0x6480a8fd29590d8b,0x69b16b745ecd94bd,0x3c8b78588979838b,0x11c15acda5f2075}}, {{0x7768fff5f253a1ae,0x4e9f61759d3d0c4c,0xa84f20ac73482315,0x12581762ab720301,0xc2e43da9374cf7f9,0x30e60b98e4e7303}, {0xbb607ae3fb97a672,0x684237ccf19cc832,0xd277dfd2936fdf85,0xf5e4a74e3d681330,0xdc6fbbeed4b2d0b3,0x335c38774d54def}}, {{0xcc45be419ea33918,0xd77d8f70eafa0fc8,0x80ed23a89c0f76db,0xacda5ac726bcf152,0x86a5e38377fe9d15,0xc4ab3b1a9f0342}, {0x59e957c2709b3b4e,0x3723baadfeee1396,0x34b149a5d65cca04,0x838c0a0bee371e58,0x615d389345111f8d,0x2df9e491b711f00}}, {{0x18f7b149f3a6e21d,0xd53ff3532877659f,0xc516c2b0b7e3de56,0xb4bd923a804cacb8,0x18058d7381993891,0x1396190ff7f8527}, {0x24dbec29a6dd469c,0xea8d997530989945,0x328cb60a319f0354,0x776f46bae6593ce8,0x33136b9ede5b5482,0xbefd8ff6d548e9}}, {{0x46bbee8d3c1c6071,0xde27bdb749746635,0x27aaaf4cb286f027,0x261237e5abfa6941,0xf67bcbea018d50aa,0xeab8801f16d6}, {0x46e7cc018efa0890,0x72d40b25b78a32f7,0x829fb44469269c59,0x604d87049beb045a,0x4f60100960f18e87,0x27d3e949dacec0}}, {{0x25a43a3ae6d153f1,0x2e407a1d59f504aa,0x6a601406777696df,0x1aae223c68dc5ed4,0x36c82de4f8ae0525,0xb94121c5872a96}, {0xd3b73e965fbd286e,0x4323baa03536671b,0x36abb2beefc5b939,0xa517cd1674b8a906,0x129184e6e509e10e,0x12854fb39edd8e1}}, {{0x635ff55a07b4e982,0xb4a0b8998d43c57b,0x9b02f46316e7e1e1,0x959b11a94101f19f,0x1231ab181f745182,0x3022ee277ad1566}, {0x3bff9abc36a58c40,0xa5d60321826b5d89,0xe94fa9d47d6ec7,0x9dd4cb7b4d6e9abf,0xd27ecd3630c77b8b,0x330307c6b90e151}}, {{0xf1b015074acd4dc1,0x1c18a0b5309fef51,0x14534105eec0744b,0xc2bf5ff74c3c8620,0xd51aa53b495f2ae6,0x1a0cb0298495a14}, {0xce665bcdfe02674a,0x9e72c906f96f0ae9,0x9c1ff45b10ac9383,0xa70787aa967abbea,0xff1f31ccbe25a5dc,0x23e1d527936c0d7}}, {{0xb99d669cf3d8e550,0x1b9d38c284054a9d,0xb80c4b0335713bc3,0x7148b4cd2d7a9b68,0x26cb0c43fc81d6b6,0x231d0760b8b8d74}, {0xa5a3ef17d96a190e,0x69e5b1adb16f7a1d,0x4d588224648df284,0xf1297c32f5016461,0xef0a7d7b23f169d4,0xcd5e8f4673ff13}}, {{0xc9dedd60b3e57f9c,0x91b8c6a3d568f467,0x95267a639e8fca55,0xc99b24f02f00f4b9,0x23cc86100d2c6b0f,0x36cbe0e9578d68a}, {0x7e526077eb5407fe,0xc236673ca3e238a0,0x2cff11f356bcf6c2,0x928a51c92791b663,0x22488fe902ba324e,0x2ee8d935cbef51d}}, {{0x2385c2d338d1cf65,0xc96f35301af9f3a0,0xdbbc4c29b8a1fd47,0xac8e26914bd1ffa0,0xeb7a0e01dc38c271,0xd9a11c1d089c9c}, {0xb232d8edec2ceb58,0x980407de2121c18f,0x28bd1330b0cf7b22,0xe58b139f8f4f7f14,0xb2d28d031ce24fc1,0x74ec816f181042}}};
const fp2_t Z_NQR_TABLE[20] = {{{0x38212f7e8ecfc5f7,0x87aee43750c07bb9,0x41a6b5b7263a8623,0x1ccff575765955af,0x4241230bb370b0e7,0x2e0b54f616e7632}, {0xc2ba74defbaa9cd8,0x1bc0f82a0d44ffe0,0x734505a243bd9c87,0x72f9ef2d5625d1db,0xe4198b0f13dfe158,0x147b912faf3f14f}}, {{0x1410623f4b12a93f,0x692c7658c133f84a,0xe6454027ea83d9c4,0xaade53b72b62a551,0x24e04ada7d217d2b,0xc25cc0502c19ce}, {0xa297bd52f2e1fc6,0xe65c734aa8d56105,0xcc4d1c28178b38b8,0x63247d936d7ff7fd,0x4b102ba060b6ada9,0x1fa90addbb99b58}}, {{0xa1132b5b73f12c98,0xc3d50a957491d991,0x408849471648a1fb,0xccf4518a14d81cf3,0xde38b96dfc2b9a84,0xe328e4a5b09780}, {0xe15bda0a61683ea9,0x72018736b049346f,0xaec081da09e140ae,0xe0f65222e2b2eccb,0xbaaa0c654be06ca1,0x38b36d2119cf6d8}}, {{0xdac6fcd1a5c73bec,0x84c9f4147eee7b0a,0x5309a25e064d3356,0xc87f5ce99d530043,0xf5c01bcec92c0ec3,0x3d327cd6dd61618}, {0x2d1d90fb02b37922,0x3a643740d515fdc6,0x6d20fd6f077edb6a,0x8d2a79f8f3b3839a,0x217f085debff344e,0x19ab1d28704cd4}}, {{0xdd03e55688ca5d23,0xd6c27bfdaa3391eb,0xa95081d83cd2e78e,0x1735b18ba9839c99,0x8496b00c287e834f,0x18e87606df4573}, {0xa30daf2ba456579b,0xa6a8ae13f99775ba,0x54b380f60bc717c9,0x1edd56d7fd4d080b,0xc7fa5d27c3179d6d,0x3370dbeaee2fed2}}, {{0x75e1dfb558dadf6b,0x7a30759bb76f38bc,0xe77cf4268afdbea8,0x58c6707fa36832ad,0xdc69fbf23af64a4d,0xe8ff1f696b7a02}, {0x2e63a6bd30d8d769,0x88258d6f5e5e34e1,0xe6e79ec4c5620fb3,0x5bd6d8781fb42d3d,0xa66444f0f83c0e9f,0x1fbdbe3ace512e0}}, {{0xdb7f7448f53f9f87,0x9d931a5044f17f09,0xff521428f39aa86,0xfaf69f25cfdf3a4f,0x1a5a33f26ec2e8de,0x21877fcdb8fea8d}, {0x1ca11fa1a1b809ac,0xdf86223d573282c9,0xd5f0444db5c49df8,0xda9f8a3c81860890,0x822da3b35f0cd72,0x234a72071383c38}}, {{0x616d54ba764cb43e,0xd6161e04b64b79ca,0x1c22f5e208203b64,0xe429d2b314630b59,0x44a5e6939e135b4e,0x36565b2c57918e1}, {0x641f8926fe7dfa0f,0x6aad5884c6472c2f,0x3441c7b7f8fcda4e,0x917e4bbf596c20f9,0x2b0e464139ee242c,0x231ba5e90ec83e1}}, {{0x77094ce561914119,0x7f94ce75e4cfe377,0x1183b8d1ce4503cb,0x1d7af6d67229b840,0xfffcfc777ab7e2da,0x387506187ce153d}, {0x688ed9f13c527d9e,0x143f79d6d240e8c7,0x871c9b8bca7b07f7,0xad71ed94de371e2d,0x66410cadd3ab8c4b,0x17f20e9ed732fcc}}, {{0x3a5f100624d6bdbe,0x6630ecf2889c6eb6,0x6ffedae11df940e,0x25d460e47f4c81f5,0x2a080741559a2385,0x3cbad907a86b2b}, {0xc84cdc74e0f26adb,0x29594cba190ca85c,0x5d9eaf30c7f5c2e7,0x40e7cc89aedef1f8,0xe250a37c97929763,0x2eb5267e6e059a7}}, {{0x57cf62856bfbb9d8,0x908d24838a058439,0x1962a3bed5aa134c,0xccd96c8d68370d53,0xde2a77d0e283ae59,0x26504d0393d18bd}, {0x11c60c061817caee,0x6977d678a4f32566,0xc17097f3a4a2bfa0,0xa2115ba8299bc6e4,0xc08b210b52bad423,0xaad518db586b99}}, {{0x8988605ba257d3ec,0x9b90bf606f3ea260,0xf3f01f6772da6f96,0x2340d64a2a34488,0x753b06db189f302e,0x4b76de17bdae96}, {0xf6eafabb4bca90fd,0xecc464f91c74b37b,0x5c5e9a20bbc74eab,0x8312491e76cdab41,0xf738887f36ee350a,0xbaf54c0cf73a57}}, {{0xe7496801b1509308,0xaf42bbfa44e7ccdf,0x649de0a3880f6dbf,0x62e7f1e7f3bb9d8,0x1b6ca0f1082cdbcd,0x3e97f68605b9901}, {0x9be8fb4cb2bddd2b,0xf045bb93b464be77,0x20962bcadc6e1ed6,0x541ddcc9e559c5bb,0xcb2694a599c2000a,0x145566401a94601}}, {{0x42884ac9fcf02f57,0x27176b31ae2c3d4c,0x1972fc4435920eac,0xee02a384233b30e1,0x48faf1f6470be03a,0x2e27a6ef341822c}, {0x710252395164c506,0xfddd663995825843,0x2a95412ed3423801,0x313fe195643d02e0,0x956b5c132ab2820f,0x2df6fcf41e8e369}}, {{0x2503589aba3cf1e,0x17446339e408cbde,0xf80ca71e7fe7691d,0xadb70ed58f8f1885,0xf330b7bb43ee5821,0x7cbcc7e512e5ed}, {0x3580f14346c2fe00,0x55a0881cabf0e8c1,0x848d5e307ba10900,0xd686025c350a0af,0x7b17e298e7b5992d,0x1fbec70a7981d71}}, {{0xab06f96fece17d0a,0xc7d76146cf1148a8,0xe4963de416463113,0x34d916fa23434988,0x9fe22d1f2cbaf9be,0x1cfd750043bb11a}, {0xc10ef43c744485f2,0x589408f8708365ba,0xef7f0fac0a1485d8,0x4bc3aa9525764050,0x46cb65196b186648,0x35500a31a6fd43e}}, {{0x43130de39f6b8fd1,0x38799da76b2766c9,0xba7a54af441ea18d,0xb3df45731491a914,0x6b86d1e8234ca1d8,0x1ba88614431c067}, {0xc072069abf09db11,0xe3cc3dce3cc79a7c,0x8bc3bfc96b18d64a,0xdcc10f4a7e307be0,0x5f492c62cd77263b,0x1f224e0b28e7394}}, {{0xf165ad12dc3dc353,0xd2d9d8bb86459111,0xf3fa68cb2edda8f,0x7b5987ce77a48495,0x5a555d5e88bfa787,0x2d6923c70ff88a6}, {0xcd182daf4ba2b551,0x984f431f96c3e974,0x3380f1bf2e0ac2de,0xedfffe41403b28a9,0xcb71d2660eefe153,0x2747132a1ae7762}}, {{0x804e4596bd626987,0x649929ae70625de2,0x4df39cf9ac57a0ad,0x988326071663df15,0xfcf510e365761c01,0x384ce93a3c4fe67}, {0x7a07c75c66a054de,0x5e7fe5d43766fb3b,0x446ebdeb8e17e64a,0x88313bcb06ee00dd,0x9c13787ab18b0f8c,0x2a5b0e0843d2e65}}, {{0xfc8d4bae190de3ec,0xb4536a6fc62d9ee,0xcc74c359e3b17276,0x384498a47b414ada,0x41f37e55ecbbcf1f,0x1892c0779ddbb1}, {0x9a58403477d6bee7,0x71d8fd2c7e2105e3,0x5ebbd7f9136efc9,0x96104cf975e28bc8,0xd6c2e0e61c08177,0x334e00fa902d414}}};

const digit_t p_cofactor_for_2f[3] = {0x43a8ffa868fe0799, 0xf2daca7934d6edbe, 0x824a11449f8c987};

const digit_t p_cofactor_for_3g[3] = {0x0, 0x0, 0x8000000000000000};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 188;
const uint16_t POWER_OF_2 = 191;
const uint16_t P_COFACTOR_FOR_3G_BITLENGTH = 192;
const uint16_t POWER_OF_3 = 118;
