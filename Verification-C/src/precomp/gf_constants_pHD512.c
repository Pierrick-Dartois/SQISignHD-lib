#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = {{{0x2ecd526e96bc3c84,0x9a166fa934aee83d,0x8aee4a765c2669a1,0x2f5736f567cbdbcf,0x6b98fe109d14b7fb,0x5f58e31976763659,0x3e4e79e714e88649,0x23e3c0ee80737b7}, {0x40f805764223d572,0xcd2f083cf26f8fc8,0xf93f1a873de8b2d5,0xc7551b8f62b40743,0x9bd8715109f6cf65,0xf3b926e9400e3e2,0xb89bc4382cd681c4,0x1bc635fe832a9d27}}, {{0x5c9f2e674bc4a6b9,0xa263ffb81d5691fe,0x2d80ce82ee026f98,0x75605d1f73274fc,0x2f8784c9b8400cb1,0x4c5a500c5add8230,0x81b243fec3f1ef85,0x629f10daec427359}, {0x19a44f2302345573,0x3f47ba80ba1defc8,0xfa79ca5148e03a0d,0xcb83b95d84105753,0x4b85f72c998cf671,0x6d11af4db9743604,0xe86fb4c9de1ee3aa,0x6a3dec2280fb1b8c}}, {{0x3d241a20f38b6beb,0xfecf85f06951208b,0xc197b05c7a1ff741,0x1df114b8258dda6a,0xf4a0d863cce8a082,0x66b559a28e14b2d7,0x2cd560d5e2b4ba42,0x4c5f74952b668370}, {0xfeafa28a5db236ac,0xdb8c3c7e5ac06c3c,0xd6562c1a163ccfee,0x5645e2d34beb9f74,0x17aa99347027c5af,0xc076e6975e077ab0,0xdb62c27dc142c739,0x7027d8c3830fa6f8}}, {{0xbc0ed365799b641e,0x6b0f4c5320061d6d,0xeae5ff5696d8bc15,0x53eda0b7940813aa,0x791d7a8cc7e64e63,0x7fb43cab7603e196,0xd6a2cb642bbdf9ee,0x6ce8f983ee4d9996}, {0xad8a1439e4cd15b,0x589cfa4d8cea7482,0x9e09ee71fc1acc9e,0x63d6f38018d470b2,0x95c314209c6699dd,0x94cfd0f372a2ed31,0xfae1670201977b42,0x18c132ce0a7feb7}}, {{0x68772b120bc91ff9,0x95fb0b7ad595fdc8,0x30f188d1ec1f4a1b,0x6b1b3b06d96ae653,0x6abc2ba6bc041a91,0xcb18c68b899960a3,0xa09d2b8190e763af,0x3905704ca56403b5}, {0x56cffb6836e39cb2,0x412da518c71823b9,0x7045d3ad4884e06d,0x75305a2638aebaf1,0xbf821813635126cb,0xd952e9949f0e430,0x7dd3323e926ecbd,0x854b230fb35bf04}}, {{0x411a78a2f02415ba,0x5afaf4b142f361f5,0xe47297337f81ef94,0xcb0ae7761103f604,0xdce2a039b2a6b6bd,0xa252bb8a1f15fc25,0xcc36ccf6f5f65763,0x81ea2a2e9cb76f3f}, {0x1139b9433f0760ff,0xc50ce99d65f85061,0x13369e33c81ff770,0x9297128959e2b245,0x62c2046672e6362,0x9ed1b88d3e31ef71,0xb1fe08c6e1a76c7a,0xb9dc0555e653894}}, {{0xf4fb16eaac81679b,0xa4f7f896b29aa937,0x15475a2e1a1cee91,0x482da2e79310df1b,0x11de65fbf18a68c8,0x9ba9a1fe27e8663b,0x3a45bb59ae142ae9,0x740a8e74f6c84f5c}, {0xdfc32e9a1282ddd8,0x7ea2c2cdeeb4717a,0x6d27c554a0fcc655,0x40e8092fb7769702,0xd97cd5d33d6e5615,0x25ed57a86f1b02ec,0x6ce9bc4a2b64cdb0,0x125dc656d76f76fa}}, {{0xe40d613fb65f33de,0x60f4c8cb2d2c3551,0x482990d20f3e78b8,0xc60fe911fab420a5,0xb4ce8a8e975b8632,0x290712602706fca4,0x26b2d1e0041c14b9,0x46ffe280756f1057}, {0x9d5450f7bca3cc79,0xe9704de57235c7ac,0xbed83056b19f22ee,0xb1808addcecf7c16,0x44eed4865d038b2b,0x4ecf31c325a6b5a,0x154c25f83d20e33c,0x4cba13ca1d5b83e}}, {{0xf04ab0ea7c48216d,0x52e5daa02444e6e8,0xb35ce02edd956394,0xfe8b99f11f3c963b,0xde1336ac239d2889,0x93456b9939f414ea,0xeafbe669a020a617,0x3c955aa0269fa8cc}, {0xeb216a78ef18c9a5,0xf90afff7b8ea7c17,0xac4b891471c4fef7,0x2400e1982e6b707f,0xe0f9494a613b1882,0x234fe2d085185f28,0x9e5ad29874e022e4,0x13003514f1f6fe75}}, {{0x11e4e7f78a918fb3,0xcd16bfffa9cbe4a3,0xd6697c92929c6171,0x3aa42e1580f2c153,0x63237456cb72a237,0x6f912332b468daef,0x873a8fb8430e9c01,0x9e59e673e7a90f01}, {0x336160d247da4965,0x619f9b5f9ba72f65,0x5e1f5bebb8e371d6,0xf55e48569c6545a1,0xa018c5bd8e271db,0xa679240fe9f88983,0x4cbf2fbc261b8bda,0x8193fcc90ce18cc0}}, {{0xe9ffa658732e7e32,0x1b0c7a4027a312e3,0x3013edd64fa36b94,0x79055d4a61510247,0x3914adfaa9870580,0xea6485b05caab635,0xe6f21707591541ad,0x9b6833789b8e0f96}, {0x98a3f7f6d39a3905,0xe32c6e1539d68bda,0xee576a7173106327,0x27b2c9825ea59054,0xf2da0539d9136643,0xa546e2d4f0c8f27d,0x23cd8b38a30c020c,0x767345c02ff4933d}}, {{0xea6e272f93208262,0x7928d9f10118d9c,0x869b6ea2d3a3bb4e,0x3f2fb65f9197bf95,0x76855a8f9c912b9c,0x6e70d54bd3408fe8,0x15c45fc78ef2dd41,0x975e5d36b9b1963}, {0x3bcce5b74b923d95,0x6859614fdead2c65,0x7b935303b956685f,0x9f8a9cebccbd09d9,0x6a09d26421686f84,0xfabef6d82e0fb003,0xec6976a75e140f8,0x7e3863d0971545ed}}, {{0xb34f54bfbd399345,0xefb13912b64152ef,0xb632a0e6e831ed22,0xb32b77460400fc6b,0x61b6408cbb02dd95,0x7ce7f91ee6fe5826,0xb0b1a58378a95633,0x817659ae31583216}, {0x66a6d2883d6e89ad,0x929ef7876806fa2e,0xb170918bb328eb5f,0x86cd0073afade7ac,0xb9c6f71e8e883520,0xd6b4c5b3dff02ecc,0x174f9e32a12ca1a1,0x68a788451ebf4e20}}, {{0xa327714b8284a93b,0x200ad51972406a15,0x2713499a02700a90,0x8e57726029e38828,0xedbcab0de71a99fb,0x32bb64a96227eba3,0x8a0b1236c70e7092,0xa068edd8885c1ec5}, {0x811fea75b98e996d,0x22d933dfb689db60,0x7b96f8dc204a28dc,0xa2585b2a09bac189,0x5fad505f0e67f009,0x4cff45f565e4d266,0x305cb17f72ff5ea,0x75e174d33031179d}}, {{0xb466505b02efa2b2,0xb2dc2af940df3783,0x38ec27030cbd13a3,0xacffb589d6aa0c2d,0xd82a4b0fdf770154,0x2ae01e3996cf1b61,0x29bf4f2dd557744d,0x107f7c2dc2900207}, {0x1e1476f340974de8,0xc70ae89bae2a3a52,0x897963ff59f6dbb8,0x588d6726d9b751ac,0x4ce07d41d39c5e86,0xd7bb77bc4c810cb3,0xeab96eaf3b29a694,0x50de9379f5fa0707}}, {{0x310d37393c174df,0x45875342e72b15e5,0x91e24f936b4943c7,0x5586c1e474398499,0x74e1c894f1b01bb4,0x8fc35e39525cac51,0xfcc0d3baa5cff52b,0x2f5b343ce81c2568}, {0x17acb7ed2c0ea913,0xd3949f0cdac3b18,0xdd70c21bbea1bde9,0xb10a09959724239a,0xc2ff0023c33d849,0xb23872c4c0dbc5d1,0x6f17a8ab8f948340,0x7436db53ec103ee3}}, {{0x1383a95ba7be12c0,0x867dabc0c9d7d67,0xbca6ade869505f88,0x3e32be0ace9a17f9,0x16c4fec09e405e30,0xaf5a127434d8c232,0x84fd9f9c1235a272,0x2a94d2d74c7bf49c}, {0x4f1759e465b6a952,0xfa9d8ec4e51e7033,0x3c8520969d59f316,0x3cdea57be6dab668,0xc6b205c1d6e820b1,0xe3e3a44bb3b79d00,0x13132de28ae159c6,0x7d5940ffd9243e6d}}, {{0x8ad0904a9a226235,0xc4c94714d9c446c5,0x1488bcea5daaca3b,0x5a21d6e6f69f31f4,0x78a8eb27ccf3fa1,0x5c003dd77750adb9,0x3aa91212b7085982,0x1affc8c6e6cf2de0}, {0x4f0bfcabfd0a6c07,0x29f073a2e917b3ee,0x62b6b5aecf3e3f58,0x98a4e94d38423585,0x5e443f55a2dfda85,0x6de76f2a66beb789,0x28d4b1d5541e0541,0x595b7d02f551592f}}, {{0x5e768cf321df7983,0xe53d4e92b8301e57,0x576a957963e56fa2,0x1039ea8b896ef6a1,0x6dde32f76fc7d793,0x161d6c58cbd13da6,0xf29e57aa76047d5a,0x46d333a58d1e3041}, {0x91abac6a7c0ab77d,0xd04c0bedc3a92596,0xd85551444444eeff,0xca6eb8077e89919d,0x2aeddd9a6a6eda92,0xb7d7f7d8246924af,0xdc9b8ccdc9d64272,0x3de4b07477306e2d}}, {{0x33bbfd7c5c87cd42,0x8c719707d6298c9f,0x3f85c569e407ab1f,0x3406431627839186,0xbaabd90a5ff3c5e2,0xa3fda7c01d3f7ec6,0x5176e2b279dc6060,0x27340ef2a30fdef0}, {0x4b3f1bde3fa8fd41,0xa8afa51617baa60f,0x9bff94de8e184c9d,0xa7c783e826a530a9,0x620256c6319be6d8,0xd491975f015e43d5,0x114274b0bb484e51,0x889ecee76ea5ae3d}}};
const fp2_t Z_NQR_TABLE[20] = {{{0x232d908504c57f5,0x1a89308e870ab96f,0x1cf0ea9a6f1507fe,0x9913377ff58cbca0,0x624f798b81646b19,0x8ddedb58644a0031,0xefb1f776840ba14d,0x88be20abcf4f2d81}, {0x173c006411ec2326,0x52766d1f636cde7b,0xc0e36bc931ee27c5,0x4507bf18681001a3,0xf754e6c83ceac129,0x7096a9bda20ed81a,0x30b040af34093877,0x70704e486e644a2b}}, {{0x3a30ee6fdcfe9fa8,0xe6b57bef6195b104,0x3cd74b0f77d7d6a3,0x21fd01c32d8f3880,0x74520505c187b4b1,0xa59a93a9e04cf35b,0xea90eccfacdf38c5,0x48992c9d1fc8a7f8}, {0xc9aab18e62a78773,0x361741d4ed3e682f,0x7f00f1b8b82a3c09,0xe8ad2a8aeb8e9e90,0xa17cf369b8f56564,0xc874e8699cdcf2fd,0x444472dc9676b02c,0x607374db9b09bcb8}}, {{0x8f5ce2b403aba5e4,0xc71aff54e404f86c,0x76ab69a3585e67f9,0xf40f7f56c6dd22c1,0xcf390a529c89fec9,0x9e959f5c14544796,0xcad9b2049e3916c6,0x3e9793c6b51c1fab}, {0x6990fa638a32a3ee,0x8c0e4c2c31594131,0x331323df413274d5,0x83970a9684f78c96,0x23b4f9bd652ad2ca,0x19b26d7b6cd8e306,0x13d586caa6be3d18,0x56280e94f7b9d08d}}, {{0xd6e2f8428d50731b,0x2f899fc80874c163,0x10c92070c0b73039,0x4de5d1a3bb53f5a6,0xb178b04fda472cf2,0x959f7d00a6976704,0x3a9455ed2dce5b7c,0x2370f403272668a0}, {0x725abba1fab25888,0xc889abb298c74490,0x2fdb8faa11247da9,0x3905d6b66b696d27,0x7cdeacb9513f6cbe,0x8888cb924a67a167,0x62722eac1905240e,0x304312171f0db6ee}}, {{0xfe3b486f5fb71c8b,0xbbd2ecc17e13bad1,0xf7e58b0d785f2ef3,0x3cde481bc513174e,0x15a7a2bc38713662,0x578e37c8ad4ad10b,0x3394ce691b286da4,0x9ec9a537b3feb608}, {0xfd337b479daa6108,0xf96a63b3bb3b4b19,0xd0528b3d411e6bad,0x88fb60fdc0d59136,0x2db28f72697338b1,0x8922c5cbc663cb54,0x733bc14ccf9bf96c,0x7d011497ec6ff944}}, {{0x784802b070c61b98,0xd665034c4d1f7a6a,0xb00586dfc2d21845,0x1cb6d8dba780580d,0x8bfb601fc28119d3,0x27977c436e2c109f,0xc7fbfcc615dec1c6,0x2fa31e628570af77}, {0xd6c71b66ba2a7a7d,0xfc0a7bff5b1481f4,0xff04fa0bd49fc6df,0x260b09541bf66e7a,0xdf2b94fec8769f31,0xad005e5873584fae,0x50a32b7375b755fd,0x6c0d410b0c9f4e99}}, {{0x5bf5b7591ea4142f,0x803b1c001ab17161,0x856306090c0b2592,0xb516b5d809384554,0x6d20f251ba7da11d,0xfae81e18c464974b,0xe7cb6877c25790ee,0x1dbf9df72f006ad0}, {0xe765b727932bb84a,0xb6d02aa9d355b416,0xbf9b8d35db2572af,0x8ac7af479b903ad1,0xb69ebd6276ce34b0,0x563921afb652ca9,0xc7822cf00647a745,0x8c43cfba801896dd}}, {{0xcb5e5341d46ad2d6,0x330d099499b0ec49,0x2db805cdd6acbafc,0x98186aa12c1e3b38,0x6b881a4b45148b1d,0xd811f6818e99477a,0xae96314b243b2f14,0x9f23541123d5aeac}, {0xcf0ce9972aa6ef4f,0xd85686d0532fc1dd,0x6bdb848389276aa3,0x8754bd0c6ce19b83,0xc6449e42b9e0e6a4,0xeb184038e7594d9c,0xe7ed389c9d69a20b,0x5c23498a2cc6c62e}}, {{0xea837280258dc36a,0xaffbf6aef3be939e,0x4feb9ccedcc01c87,0x57103cd6abfb6668,0xe794c8a8540530fe,0x2f5cf78c3e743e98,0x1e58173bea57798b,0x25822d387fd04916}, {0xa6334a11707e20de,0x1de891fb5cacb615,0xe29aa04dbc49c864,0x1f1d58a640eb0697,0x348f81a7d539225,0xa5e8cf971367b4ec,0xdabd65713556a43e,0x33c7d23d3dd63812}}, {{0x7500970f276befda,0x3fe232bde7c6ef5e,0x9e5cf851014c5399,0xbf1399ef8424fc0b,0x2426152a9fb8ae11,0xf4917a276c5be225,0x73dbe653c16f08e5,0x48d1c55aa9cbec05}, {0xe427ea012a582885,0xdb3cb2a00ec68920,0x5262eff5312cc39c,0x90af702d91af3dc0,0x5a4de0a1b683b92e,0x3d344427236b9fe,0xfa32fe3917dec44d,0xa6484f6a478e144d}}, {{0x9bfc90fe0c5a3f44,0x8724e753c1ccb35b,0xe1c5cc88d7233a1b,0xfb348780c690f184,0xe0668228281540ed,0xab2ac09939e75720,0x97cf0a79c5e37270,0x5d2e64b6909a84fb}, {0x63e6e25a3e5a413f,0xa6c5a17a0aeedd51,0xfc21fa1953ba2bf4,0xf150e436fbde0ff8,0xeb109433b5046002,0x1ea6d5d385cc04d0,0xef00cab46917b03e,0x2384abfaa0bd2881}}, {{0xfd94784ae9aeefda,0x6f85b9a01084a91,0x4b57e80bf6b420ac,0x989f12b2f058d303,0x9fb11b0d3d1db5a5,0x75ffad2f722810bc,0x93072425873c5445,0x6387a116e7d7f27e}, {0xe51a26e2fef735d4,0x7d34328739544359,0xda82800129bb188b,0xe204c2892c91a53f,0x7f7e94ccb401f456,0xdc76822b66d8e944,0x6458f0d07dc24691,0x3b6086cc86dd2bcf}}, {{0x8ac0f19b7a6e8d17,0xc2793491e0d300c8,0x87a3d63d207ae5be,0x30c847c626c5940f,0xda55621d77a4b24c,0x59b3d0dfffa916ce,0x11ec61cc945aaa92,0x2dbec6af5455215e}, {0xd442b7f717ab2441,0x2b778e268d98e036,0x79b9ec99384c72a4,0x9a4e356ad48fdfae,0x1b745b440a4db01,0x3aa0ac6021a598d7,0x678ea98e435a9fbd,0x3a4b63a7df142bc4}}, {{0xbcfda96d23b8e4af,0x5599e65a5dcd7a37,0x4003dd2faa9ba300,0xd59dbb0d5c4791f8,0xed1c0337fa4c3a6b,0x2573d4b8feee9878,0x69aaf4fe9d8206b0,0x9544dd84202d9817}, {0x7ff3e96045086a41,0xda97830a3c519487,0xb84ad123e7c3675c,0x3e932a2ff8efe75e,0x9cc5f4fe5d0980b5,0x98bdb807d701005,0x59f9b73a91d293a2,0x92cbb011687ae966}}, {{0x8b38f06b70718ab7,0xee6d678d0b9ed4c9,0x8c0a7ab4f99f80dc,0xbfa7d0a8a24abd07,0xe18738accf0137fa,0xed0ec60d568a89b4,0xfe64de4898b5a156,0x8a2b5e5ad1cc1162}, {0x319e4a1a2889b21f,0x81450ec22d81a315,0x291f773fc5e75c9e,0xe131d62ab9295e9c,0x5786fbd49b0ef7d3,0xcf760d17ccea4775,0xfbc440aaab303602,0x7c665facdafb1f19}}, {{0x732408e9eb4f9878,0x2b55613740cd8e55,0xc46048c727ceb3c8,0x4fa10feb86326f15,0x4538a7202771713b,0x7758c5e1a7ed7528,0x2dee3bf1ff5a88a3,0x90a8075fcc08b3ac}, {0x6cf39948a1066766,0xfcb8a5f67b4a1cf6,0x6fe6aeac8e5dcd2a,0x803905169b4ea5f8,0x434fbf9ec3d0e658,0x9e7fbf71cac52ab2,0x950d9ad311b2713d,0x120bb43fde55a040}}, {{0x85ac125d309e4a21,0xeb777e07ac07c3e0,0xd29595cd66fa965e,0x426d17133d3cf57,0xd1885ffea01ad150,0x197ee6e4e6241039,0x53057f8d679b7dfc,0x1077a582311534dc}, {0xa86461820615028e,0x8ee2c53e8694805d,0x396bba9dbdd09153,0x344f4cf3da02f90d,0xec7c9f51b156088d,0x704fbf325a769e0f,0xa9f286f42a492314,0x58226b7e3735aafa}}, {{0x95a22f8dea03d15e,0x15c855660600380a,0x4114808d62f5536,0xf714d2d75611544c,0xc9f0f2b8b9ecaf71,0x76a1bc863631879d,0x5ee83531357515cd,0x86834f0520629db9}, {0x8ba2ae6438a56867,0x407198b4f41d7899,0x11d2af7469e630e,0xcea24c135a880311,0xd4869309ca00f95b,0xde0deb020e0273e5,0xa428c52ac3192df2,0x92ca0972069d674c}}, {{0x2fee9212c934c7da,0xb67ffcc408fe8b51,0xb8c3b032dc2bf47e,0x49e82198b168f5bc,0xe8d3c021d9f8f55a,0x570b6f55ef99435b,0x555fa831c4f89319,0x634480d2bcd2d8a3}, {0x3635ca3e4940193a,0xaa8842806ab80352,0xd3c3b72926302e86,0x3fa1915041d64279,0x8c928272f2960b36,0xa36d3d91026e54fb,0xf0a780bad3ec4d57,0x99fbeb5133291726}}, {{0xbde7e589ddfaaa99,0xb85a335b20319334,0x753d9d6294a2d725,0xe2e28854fb8fe15,0x916401f15adbbd75,0x6101944741169e05,0xf26d33b7fd0dd78b,0x89c8cb52d0cf6906}, {0x4be6338d2fe812cd,0x1de0b4589cbe1e2e,0x627e9cfbd3d48a87,0x18b928bac5b85262,0x8d8e47a00bbab280,0x33c84fe814c576a1,0xf5b3b60f6d5259b9,0x36131b6f4a630b63}}};

const digit_t p_cofactor_for_2f[4] = {0x80429e2d58ebb467, 0x52e830945c1a0446, 0x5eec151f0a69c447, 0xa65f4ee938387923};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 256;
const uint16_t POWER_OF_2 = 256;
