#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>

const fp2_t NQR_TABLE[20] = { {{ 0x75fe5e4e3e03d42c, 0xb2577df3134cf430, 0xb6224396b71f1bb0, 0x6b8d55797b5c00e9, 0x4ecd8b2db10f2f20, 0x13ea924e9fe4c7a1, 0x55736debaded9630, 0x762784bb173bf4f5}, {0x1a886b06705a94bd, 0x435c3dba8202ebef, 0x4300b712778441b7, 0xf565953596dd157b, 0x88b11ca825b1153d, 0x8f57d4e8b19aeded, 0x93e52d261893cfc8, 0x9d58185b8cb9cfd0}}, {{ 0x1b62b69572015b30, 0x99f3bb78cb74d021, 0x2cf59470058b3618, 0x6d9f66bbd23dc3bf, 0xb1a87457f7428b93, 0xebf03f4ba5c65dc1, 0xe3e6ff6d2ba88b2b, 0x3458bed4906074c2}, {0x04d7008d04bde6b0, 0xb01b6e898b6898d8, 0x6f62befdfb52c273, 0xc5c546d98cc17419, 0x6f15dfb48e2922c3, 0xfdc0482e0bba7819, 0x2af3d1089b68a4f9, 0x1556d4161b658140}}, {{ 0xa3515ad253e45e3b, 0xdee35607eb840ec6, 0x0769fd5ae94c7be1, 0x3664ae5f4db5ca1c, 0xee430521f59b972d, 0x7a78d59b907335c8, 0xa4f72aa0d4b42138, 0xa60e6ed8eb0e2a21}, {0xd53b75d33cfcecea, 0xbcf568a7b6d192f4, 0x8d414cf05db73d8d, 0x94e2e6c4761af955, 0x07dfd0860f143b46, 0xa487f5a43f2cedab, 0x7e4791d6f8fe1d6f, 0x6b80ce6ed30c895f}}, {{ 0x01251c9252e52057, 0x628b6aa8402ac6e1, 0x85a9186b1176f5ea, 0xe457ba9f29f2d0ee, 0x5ce3d0a3d5d80f78, 0x1a8107c3e5e7d233, 0xaef71186895ad39c, 0x63676824b01ced31}, {0xee4548b09b2e08ee, 0xbe301f733fdaded7, 0xc7bb469f366b0e34, 0x454046901ffde02e, 0xf0ccd7f6f6748a8c, 0x3b9354069771a3fe, 0xa70e9245f133ce62, 0x61e80e958ed2966a}}, {{ 0xc69fa4cf6b12d7e2, 0x9c5b4ebb27eb8963, 0xa313e19ee9478ae0, 0x5eb3bc0d65164f81, 0x30ce0be78a25cacd, 0xe21343d9e55bbbd8, 0x8ee083bcaa48f418, 0x6cc85e86e77fb3a4}, {0x96fef9f1a359c67e, 0x7f81507bb1d9cc5c, 0xcb3a36d01e293e6e, 0xce1ee743ea87c561, 0x08dd5cb3e2076664, 0x6d43ca24702972e7, 0x05343f0aa94c5c9d, 0x5d1393df32276140}}, {{ 0xdbfbc6ed468e9728, 0xf0d8dcd81af46ee3, 0xf27682e2763a5800, 0xb15ddbd1bbcef3a4, 0xa9453da050557fd8, 0x1c13b176bf8a72b6, 0xf3d666fb972be46f, 0x12cdf89d95d737f4}, {0xbb95f590c44476e0, 0x551930b8352570f6, 0xb9c194062af4c20e, 0x01b4be4ea42bbfeb, 0x5802c4e2b004825e, 0xa1ea087d7606f924, 0x25593c3f980d85f3, 0x5152e939e6e21f39}}, {{ 0xfbe2331ab9747999, 0xd82aa20bb7af2c52, 0x65d9992dd0ba8085, 0xa5b6e57f6c9571c2, 0x816dcc463931053a, 0xc2b24631b2b233e6, 0x1b5d970b948f16d6, 0x67a7dc373cbb6ff9}, {0xcf7a9d6e8bf8c2c8, 0x70d451dd8e2132dc, 0xf923a8c115c27285, 0x696e75562629d33f, 0x6557a78fd1c35271, 0xc3cd01d2851e3c6c, 0x68fa36e03c8bceac, 0x2f9a395f86363dee}}, {{ 0x70a039fabbc9d796, 0xafedb2a3654d55d9, 0x9c8b22ea0ccabf50, 0x3c6a2280f0187046, 0x665008618c3f4c76, 0x8eca8ab0fd557d93, 0x5fe3fbd26eeaf428, 0x28a46b52cf2f6554}, {0xd3387b44e36adf53, 0x1c1219516f26d117, 0xdb886286b7869d96, 0xbe465c4742f4002f, 0x234aacdafb531b4a, 0x3bc70a8f2576c622, 0x0780ee198c30306a, 0x896469f6a6789b0e}}, {{ 0xb6a1ea53ef8d0cf6, 0x8be6db675c46b329, 0xe0be8a3cd6176d87, 0xa2e1548998898cae, 0x510392ba07f574d2, 0x72620b28cefd2c42, 0xcc75e995e9f215be, 0x583c3a937961da59}, {0xf3e9bec716bc697a, 0x8a33b62930acd399, 0xe2acf5ac8e9b8f9d, 0x4b3dbc89d3fcaf75, 0xe773ff69c107b5af, 0x973826494fd1f5cf, 0xb1567a135b623bc1, 0x294018a183df664b}}, {{ 0xd40d214c1a925262, 0x21c3f39e960d4038, 0xf4f55cfdfbe9f711, 0xdf8ba17767328835, 0x5256256a1747f9b4, 0xbd4ba8d740b0fc82, 0xa5e46d8dcf91abb8, 0x62d62bf7955bd57a}, {0x80c1d3fccb07a9ae, 0xf110bb36af669ef6, 0x39e7283060c506b9, 0x43b5ea8631daf9e7, 0x79901e89681241a4, 0xd3c716fd8bc945dd, 0x5ce880512a1c7d69, 0x2576e189b8d4938f}}, {{ 0x1a3a5dba41cb0f11, 0x7db60334202d2ae7, 0xefd7bbc6c422ff85, 0x13fdab58cb9a63fe, 0xd630107d303c5e33, 0x97fa8cede5098b03, 0x1ff2bdca674c5d7f, 0x77bf12f59858bdb6}, {0x2c7464f777a8b54b, 0x85c8254dddacf655, 0x7c8635a4835da25b, 0x6ef75a1e31506469, 0xf077a769fcdd2856, 0x2c88eb5a7b51f69b, 0x1a6b8f925ef7ce66, 0x6cbde6c0d7db8841}}, {{ 0x26a0477bb8127852, 0x0699df4007003111, 0x84289d88a61f207b, 0x1bbe46d4929bc845, 0x16a6974d384801a6, 0xebf77443261f426a, 0x356232ac1bab783e, 0xa2a866a4ebcde281}, {0xc2f29676b04696dd, 0x33fe96b8d2bb3bdf, 0x75c12d9bafb0b0a4, 0x9fb5595e1a68cac6, 0x1b932a7f4b49050e, 0x54fd87bf8d1161b3, 0x4d1bf30b4229d08f, 0x92d323a5a04a10ea}}, {{ 0xfe6965bdb27d9ae0, 0x1fbf85a92db08b61, 0x82fcdac021327b08, 0x21e624b73cbe9b6c, 0x7739f005e09306bd, 0x12bc037c74487c33, 0xac8ae4adbe658967, 0x2b998b0b46022607}, {0x656e51014db09187, 0x9d2d7bdc4d529d9d, 0x8d716dc263d18367, 0x1968e29741916347, 0x026d966a9de9887d, 0x6a7f97ac40d979ad, 0x2dbe49dc4d179649, 0x41cec145f9ecc57c}}, {{ 0xb6294fc1741a6fd3, 0x8ea9d11bb908cc29, 0x6a0b21578f39e626, 0xff492689b036f8a3, 0xaf001e871247c232, 0x2e3fdffb6ba37f1a, 0xeb3ed212e6aeb882, 0x4e146a6ad56f7c7f}, {0x297bbf78422b8031, 0x0c584f2c3e83ec06, 0x5255971c6005bc15, 0x952e64bbfe3d02f8, 0xf0a86f22ed730a45, 0xd7ea087ad6433c20, 0xb855ad6786f0683d, 0x7361c56fc8fc4e13}}, {{ 0xab7fbb70d175cee9, 0x585ee9a67108024a, 0x478ee831e6f08182, 0x9cb3a8fedd66555b, 0x0a213e0cfce4067e, 0xa7c91aa434400cfd, 0x6668aa0c8866378c, 0x3b572a59b75fb11f}, {0x469d8654fe848493, 0x91e86d074f8cd2a9, 0x5114695980676fc1, 0x7e655f1710283508, 0x580e26f3fb9170c0, 0x8f95da407cd9670f, 0x6b0913b24e760833, 0x977509d5c1a6affe}}, {{ 0x140dc2d9671569d5, 0x64a90b040f64bad0, 0x21b4da76e875f588, 0x104e3ad587df8007, 0x017c2d7ca573a8b1, 0x4d4e6794bf57b7ad, 0x7f37e4ee5fffb88f, 0x61d02660b1061360}, {0x01c66a1739ec7703, 0x0b41bda770bb04a5, 0x03f6df6374f9889f, 0x6a8ef8a8b29ebcd1, 0xc100b4761784716f, 0x64160d3efc24988b, 0x7eb244bf21f09112, 0x93e3eae803d836f0}}, {{ 0xe242fae95da33807, 0x0102eae0314a0827, 0xf0d4da2d609277db, 0xe20d273ed589a52b, 0xaaf9b52637a92631, 0xf5cdf0a4aa90b6f3, 0xc00def1bcd4bde5e, 0x99c8c39bb6377d61}, {0x01021268a83e9023, 0xeb0b03c7b22eafeb, 0x2d04107484ab5871, 0x904b8c4a639a73f1, 0xc095b024229446ad, 0xf6c2882e2832ce45, 0xc0785b8bd92b0cd0, 0x1fa140685d453a0f}}, {{ 0x47431f3df050d588, 0x7aa0c7ae9cbfe842, 0x04a9f23bf16ebe94, 0xc5166c8f9ca4e608, 0xb4da9df246dcbdb6, 0xb71a584ab1496fe8, 0xbe7230cede41496e, 0x4fd4aa305e8bdd87}, {0xa70854e65a95824d, 0xc1913ebf0ed807e1, 0x0d17323d8757e734, 0x16da9f3b85a01262, 0xb10a434766dd9c23, 0x1e952a76bc4dd571, 0xb636ab0f2265bb6c, 0x994a5c64780c686e}}, {{ 0x2c6a173e856a918e, 0xcbd00190584349f1, 0x0151f06f9b1da500, 0x7dda90dc56923708, 0xf2782a5894e8e54d, 0x9bfc626e05d34da7, 0xb2fd67a96fe8ecce, 0x237cb4a7f4cccc28}, {0x7e37d7169fc02f87, 0x861642b58a654450, 0x97db8dc417578907, 0xdd4a0b153e92d058, 0x0e081b1b18bcb19e, 0x3c1d70d5494d7e89, 0x305b01ab46c6bf49, 0x446289863bab1a33}}, {{ 0x601d9e02b6adff5b, 0x51a19c5ec99ec54f, 0x51029d827b1d7759, 0xbc74f9f9098a0f13, 0x7ed5d8e4f6bc06fe, 0xf091d572df522de9, 0xda94ec79a373b29d, 0x737dfd965807bcdf}, {0x3304f5f31deb4a35, 0xca1245c40233625d, 0xb3443d0505375ccf, 0x7cf75e2eef33baa3, 0xc200a22a16e996c0, 0x62e5572b566343bc, 0x76f19abc3b15adba, 0x2c8bfaff213469de}}};
const fp2_t Z_NQR_TABLE[20] = { {{ 0xf54e97e181c262c6, 0x53c86e292b7bc7a7, 0x7e5ad5917bdba481, 0x9fe4ceb6218d9602, 0x254c0f615205178f, 0xf0b94e6a022c008c, 0x4577187af6f861ae, 0x2a56ec7847710c1a}, {0x3917a2f75790edf2, 0x72f9b58b805f6ad5, 0x959a9e9e30ad4da0, 0x82537b984c5c4cab, 0xbcff19eaa19409c6, 0x6e3fc93d727fa935, 0xb4737a167d866b02, 0x8db6b858cfe0809a}}, {{ 0x64fe5d879ce29767, 0x8542ed8321ca5f3d, 0x470ff23841848d8a, 0x1e143552d87ef3f5, 0x073d3dda2066f951, 0xe4c62532b8c71802, 0x81f8d5912ac72929, 0x5efe083595a57bf6}, {0x15d0b39ebce3ea45, 0x733031358b0ff4bc, 0x372468e896ff183c, 0x62b1c8138c719b06, 0x2f445fe183bcd54d, 0xa4613af01edfba07, 0xb3f725fc36f91929, 0x1f823cf048ed4c56}}, {{ 0xa08722786cbd9813, 0xd607acb06eef3fe6, 0x1b7b1fa37031f637, 0x2a81e55cf827eda2, 0x9fd23425685936bd, 0x636e46718c35fdc9, 0x192d380b8371a707, 0x1ae0a110a23f8d50}, {0xbb644b1070cd871d, 0xa26708a6dfec9728, 0x2aa4f38c42574788, 0x3210499aa39fd60c, 0x64b6feca6a2d1956, 0x746a736086a534c2, 0x472278482238e751, 0x8383a177007e46ca}}, {{ 0xa49e25aaeaeb44d3, 0xf88c7c678e13db4e, 0xd67c622e6f422db0, 0x49cc640c815fa401, 0x8216caa57e21ac91, 0xec01ddfbec452f1e, 0x9b274410af5d693f, 0x75e5ccaddcc01c34}, {0x509cc741e226f445, 0x941b3e98b5a7e0a3, 0x3a5575d4c8995467, 0xb98706dbf90e0e04, 0x5e93892eced0d527, 0x47a8135616374f25, 0xc89ebcc92fda15ec, 0x98e1f616439dc2e4}}, {{ 0xa9ebf30e7ccd6950, 0xd8c3a126a06353cc, 0x532d2281b7e2a8c0, 0x36eb235e32e9d27f, 0xe60d6220deed63ec, 0xaa7e039f8b44db38, 0xe39b0a7e42ea1f96, 0x5d6fefbf022d4705}, {0x8c317b0ee8d382a1, 0xdd7b62ee08da5106, 0x3c16abbd6e743308, 0xf9c00307e35b177a, 0x47200906ab247d42, 0x296b9256272970d5, 0x458575916a6567fa, 0x411e2f0d2f079868}}, {{ 0x6627a43308ce5db0, 0x34e8995683ff233d, 0x599fe82db6d5bf2b, 0xa1ad8d8d1fc188ad, 0x791043a76f10f0d1, 0x7e7cc8291f599560, 0x8e15817fe00e30da, 0x16fe7ed82ee19c9e}, {0xc07cf904c609fa48, 0x2fd6f49f6b373472, 0xedc5db8f97281481, 0xfc72ac06a2d3a79a, 0x8e28a2a696015f38, 0x150a6d669cbe8cd1, 0x492daea1c33c10df, 0x9c5f251a368dacad}}, {{ 0x3699502d095fe0d9, 0x6aa27a25bb1af741, 0xd0d1942d758c635b, 0x74a5d08ee6076fdf, 0x804cbb94e6f56544, 0x4952602ba83b20e9, 0x21b4b409fb8ca28c, 0xa2595a8d03a0bad1}, {0x2afea249fef7ee6a, 0x17b0da224e7a06ec, 0xdfbe42dd3cbb601f, 0x007b2060ae36382e, 0x599c7ae21f79bc13, 0x12c5a6daa53bb423, 0x3966b2aa3f9f0819, 0x1866c3c8795469c2}}, {{ 0x8ae9c0a2d7d57675, 0x64ce6f9160ffa0e0, 0xf0f02fdc76afbc1f, 0xda4b8c6d70a874ac, 0xc607a7a8b3169bca, 0xad8dd662e9fc8f80, 0x508ee4d26a23ba8c, 0x5d748912d83bb06d}, {0xa7189860f74a4a49, 0x4091e501aece28f5, 0x9159e06b67fa3199, 0x23749c3f395e991f, 0x84bd5b5080bbd329, 0x91f112ebd9df2d64, 0x5f5b8db49f5fa6b0, 0x8c7a97cedb362bdf}}, {{ 0x4bbe432b062c6abd, 0x3821805da2f33660, 0xd15717098fcedb7b, 0xb328ab69feb38978, 0xa0e97967537514a0, 0x0f44a2310d59373c, 0x42c77e2f8a378fdb, 0x74c715f7a675114d}, {0x5f312eaaddf8382f, 0x763108ff7eb1ac2b, 0x3359806414bbbd20, 0x3a905af598ee30f6, 0xe6a84965eabbd309, 0xff236a2926ec833b, 0x587b9633d270b942, 0x8e9e1b414190b4d4}}, {{ 0xd4000f5daae91048, 0x6057cc1bbb6f3f19, 0x6a6664270f413651, 0x93cbeac4066e6ddf, 0x07d384078e520034, 0xf283f82ddd024791, 0xd6ea2902a349c355, 0x53e9d0f0b1d4f4da}, {0x26058e6851bc9ae8, 0xa77f7eecae6ef892, 0xdf305ab98291262c, 0x963a4c07d7b75e1f, 0x17327f85f619d684, 0x6d5a303a4094218c, 0xfd23b2423e4b1181, 0x5fa52d4649beac92}}, {{ 0x534d48ce7c32dd5d, 0x5b28ba1bb6798d19, 0x1b732748831b1a5d, 0xcd4e6b139015dfa5, 0x140fd5a66c8fa342, 0x0b7585a1328b6f71, 0xdb0e00761b90b1a1, 0x32b381cc8a2caa3f}, {0xbe583cf9ce52aa72, 0xd0ebced173f1b43d, 0x0aee11b9ebf25d32, 0x2d7379dd16219cd5, 0x8382ba0e9624f76f, 0xd3c348c704d1caa4, 0x008c700001c8bb41, 0x2fb857f70e9c80d1}}, {{ 0xa5e8660383e08631, 0x85dd2831e2294566, 0x8e4cb933a1386304, 0x1410a55495909d6c, 0xb6facee2612e9f1f, 0xb0508e25b7e96353, 0x8f162aad93f063e2, 0x71f2e9087fd5f837}, {0x0996d337d1947691, 0xb1a6b2eb5c30b544, 0xb6f88689f9404603, 0x4f28cb0f3ad12824, 0x86baa4be513e7a99, 0x0befe7e32a832393, 0xc9f60b98cb8460e1, 0x42f60a88cc4ce598}}, {{ 0x93c062d7e9ece2dd, 0x66a8b4967f17dacb, 0xa3809c57fb68409a, 0x59039a57889b278f, 0x73a6cdf28e358276, 0x7c04d6750f799883, 0xbeaba3e5b4c64b46, 0x72f7451f3297e871}, {0x900501c22a870a61, 0x818463a357e64f01, 0xfceac8da450a82fe, 0x7139db42afe4c748, 0xa159d7461048ae37, 0x78bc8cd8c478d93a, 0x6d2d8ccacb15d91f, 0x6eec2f0e5d7dc4b1}}, {{ 0xd5b4a041a3c4c3b1, 0xa678d0cb7869ca0f, 0xfda0f961f75d0a21, 0xb222aa6a4bddef4c, 0x4d7c6e17a68e61c6, 0x0dd2ce32abb61720, 0x2ee427a352ba5e73, 0x25696a21440410c0}, {0x9abeea24ac2bcf04, 0xd0b750a00cfdc11b, 0x147f452d0ca878d3, 0x52db4c235957e27b, 0x174ffe2ff7e713f2, 0xaafca83cead5cd33, 0x701e9fb2418ab9dc, 0x55d20c50e3f796c2}}, {{ 0x49a87b33ed1f949a, 0x859e089e675aabb0, 0x17ccc09064a97e5b, 0x6d34aa8c7ee75fa6, 0xb364d72520a2adf9, 0xe7d1837fe39fb266, 0x77faabd8f7dda0d2, 0x5ff88b1606136113}, {0x0c2e63db091f57ee, 0x26dffc84819213b2, 0xdf2dbfafa1a6abc3, 0xde6c23da106dff16, 0xe56457a50c5e8cd7, 0x3cce77db6be7753a, 0x60b282a5157c31b4, 0x682c376adb4c493f}}, {{ 0xd4ba417cd2cd4f07, 0x860e98e921f63c68, 0xda08042dc2e286ec, 0xff93f1848893d704, 0x66face5e418342df, 0xfa01b8de586322ea, 0xb6c23786f24e5254, 0xa5cca50558515fd7}, {0x1656f15f455c2311, 0xabdaddbca243b7f5, 0xeb5551b98582b8d1, 0x1c1a0103ae1883d4, 0xa4dfce762f70bbec, 0xeb48c5b294c3320a, 0x0d865e298b224d5e, 0x97ff4826eb2699f0}}, {{ 0xc7cf42582c48bba0, 0x9339b98bee1bc492, 0x76f041b6bd11ed7e, 0x27f9841a6ed1b4d0, 0xc6bd5b70e8ce3dcf, 0x748cf18cf4ab8ddb, 0x25a109e447c7a3fe, 0x94c0a60d3452058c}, {0x62c4786bbec82c0c, 0x4d561bc45a78f04b, 0xc645fc4edcb63140, 0x6c55fe876d60a3b7, 0x7735421f69775981, 0xcc54a3fdfce00da5, 0x984692b615fda1f9, 0x9fcb36a3866d17ab}}, {{ 0x4398f565cac9dec6, 0x5772ee6c2b708c86, 0xcd6e7b7dccc06aee, 0x711f7f47f38d4bbe, 0x84eafbc297587895, 0x93dabc592505b448, 0x3187760adae00772, 0x2a52ee17536e8fa0}, {0x914358b4c1638012, 0x7be3c1d47edb0625, 0xc660104d40fd06b3, 0xab238e9fbad8177d, 0x9e87d54d0633bae5, 0x9972a90e0530b0ff, 0xa0be5fd9a3bebeb9, 0x213c8110091cb85c}}, {{ 0xec6d2d967b0e5b05, 0x1fa3c2454cece13c, 0x0fe2ef31b569fed8, 0x18345f7414af7af6, 0x908f2638f2af64af, 0x5b18aedb613ef57a, 0xbe79f4833cc58cb4, 0x6a88d062199a9719}, {0x1e9bab4e1f67297, 0xbf477b70acb1156b, 0x2b8b4f74d1fcad74, 0xd6e50dde90f0ff94, 0x291f87e9c1fac537, 0x50b75eb80b4dffb4, 0x206900c63d7cf5f5, 0xb545cdb39cd5d4c8}}, {{ 0x469135b1b13d3522, 0x411fcecae90e216d, 0x0472b6b0753a1891, 0xd1292336b0a5d364, 0xd4f69db35a770642, 0x7f85f30e87c6b4ae, 0x0348106e7d4c82fc, 0x6538bd1e9fb9aaa7}, {0x244cac7f97892404, 0xbc3c088eaf8119b5, 0xbde69a145895db3e, 0xa30de26f70b107fd, 0xb201c4391cb8382f, 0xa5fa012ac11a88b7, 0x4cd13d924b6fb82f, 0x4b639dab90710dfb}}};

const digit_t p_cofactor_for_2f[NWORDS_FIELD] = {0x0, 0x0, 0x0, 0x0, 0x80429e2d58ebb467, 0x52e830945c1a0446, 0x5eec151f0a69c447, 0xa65f4ee938387923};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 256;
const uint16_t POWER_OF_2 = 256;
