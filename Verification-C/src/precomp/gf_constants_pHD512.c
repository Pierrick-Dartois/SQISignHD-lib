#include <stddef.h>
#include <stdint.h>
#include <tutil.h>
#include <fp2.h>
#include "gf_constants.h"

const fp2_t NQR_TABLE[20] = { {{ 0x7eaecce13509521b, 0xe57075a97d07a2c9, 0xdb856e56555dcd39, 0xa01cb88014970e11, 0xc10a29d72f68d2e7, 0xc4f87fe99c9694c8, 0xa54b6d2f7e011bac, 0x54f31e0c3ab29278}, {0xb3209e9c864cf9ab, 0x182d88b08c4b72f5, 0xb594700d89ab63cb, 0xb4a922fd29891816, 0xdbe3816e1855b5ab, 0x3c359e9762d4668c, 0x6db711b0885634ca, 0x436d145cd36ec8e9}}, {{ 0xd282551faf07dec9, 0xd650c042fd0ff1f3, 0x41129e6919d9e042, 0xd675cf432893f9e8, 0x159d99db55deea1b, 0xebcea721fa5d5c65, 0x9ecc892fa4fc0fe6, 0x3ad48a1af99252e0}, {0x12b5be4aa287c9c7, 0x2aab9a137c418a4a, 0xff4af3a24a3f974b, 0x586b52efc241be1a, 0x79a0e6ca5eb1e80a, 0x5c0d9579cffa1434, 0x5ecfc49adb44554d, 0x55825c920796ea3e}}, {{ 0xc01a08d322ae6a61, 0xeb09a7d36c15f616, 0x1a3b5aa161f69e66, 0x67974ee649b41110, 0xf9a074da06ee3d57, 0x02f31e696148171d, 0x3df7e50a854fa3cc, 0x7a32ceaddf4d7c39}, {0x8b18c75a5275b98b, 0x4adc5fe76fda2d4f, 0x4c941b026f903d02, 0xa436a857e83e4a75, 0x34f11438c22fe536, 0xaf7a90fea7bab521, 0xeea78324ff42436c, 0x90d73a8eeebe1109}}, {{ 0xd80d37cf3e14ade6, 0x1c228e109e9b5b67, 0x1ecb9dc804d68db8, 0x6238fcf54431a805, 0x7eb3a1dd5ea6027e, 0x2b865429e24e3b30, 0x4709792656b8fdf2, 0x874cc297106fcdd3}, {0xdff9a371b827d12e, 0xa4b0abc638d49a14, 0x5b02b75864d36de3, 0x0efbc3d948ed2982, 0x6025dcd912f18d17, 0x4a680577f0c631c2, 0x1fc0a85284cbe37f, 0x8c8edd0b57b460e9}}, {{ 0x2a85b4dc8539324f, 0x43e6bd028367a475, 0xb0ff2a5d312d5796, 0x168d3c9adb43083e, 0xbaad0b87b2a98e3e, 0x95b8e8d6a5f1f97a, 0x8fa159d3998df5a2, 0x218be92b94eaf74c}, {0x33d80c593482fe62, 0x737f21aa576974f9, 0x3afc0f4cceb1ca3f, 0x288fda144f09c370, 0xa3af973ea915afc9, 0xcf11d472a237747f, 0xb0125b097a53889f, 0x32d75319911c7906}}, {{ 0x5e8eeb214e1ffa6a, 0x9cc549657f62fa11, 0x7812272dd5450e59, 0x8815ae7b7713f001, 0x21ccff1b3739a61b, 0xece07df430c50752, 0xc59cb52916f6eba9, 0x9f70742e58e1d780}, {0x1192ee46e2f74cf6, 0x808e4a97eb73e73e, 0xd62d0b8b21d5456d, 0x8154b1e2cf6afe25, 0x46260710215ffa19, 0x51044714be84fc17, 0xbfeabc36eac63136, 0x926ff20ade177b61}}, {{ 0x48cfe83baa7bcc32, 0x4d8a433ba2862128, 0x84c031f90e453dd7, 0x300508f317bdb304, 0x223151905dbdd804, 0xa95f42a7ec40795e, 0xab3a8e3d19197381, 0x16239f2d41507f97}, {0x9c21b07a5053b414, 0x9e8a4ffeeec683a6, 0xcfa9fafea397aabd, 0xe440efad4a544843, 0xb1b143b104248d85, 0x45135f75986a89a1, 0xd41cba61f54d8c7d, 0x9613fc53f5cfd861}}, {{ 0xdb2f7f17ad9190c2, 0x0a84bea903d6e811, 0x146800b1f2d88401, 0x2bc0448b98b846a8, 0x4d97c55a6222ff0e, 0x6e347dac17429e84, 0x89cf585281ae2dea, 0x1367df0e95ff884b}, {0xab2b9ce19411fde1, 0x6e6c172d72bc1bc6, 0x3c9dad809f1746e4, 0x5af1e7c64adcf739, 0xc508b8a21d5fad52, 0xa512cec4e91285cd, 0x7efb0bd3d0a9ae2a, 0x7a9ee0165c3f4077}}, {{ 0x6544c82d34b830ee, 0xc00b6ba3079e9afc, 0x998d77f714ea1062, 0x7ded1575ab05c955, 0x87ff86cf6ae041e7, 0xca3a5ccd86a60569, 0xf7db8bb96b6856e3, 0x7724eba988046e74}, {0x4e362848d93c6032, 0x26f96d14d649d131, 0xdbc68064539de665, 0xfa972d1118ab88e5, 0x2936f6985e757483, 0x26a5823f1684863f, 0xcbc03937bc92094a, 0x289ebaafb49f3ae2}}, {{ 0x4470d7bc9d94506c, 0xb9ea00744bd7ebaf, 0xa9539d1394daf455, 0xe144f35c10f394ed, 0x50caa9e6b0d3fa5c, 0x5ffe05ff033cf67d, 0xb1a1b4263ca3d735, 0x899e6faf2c336cd7}, {0x14267619d73fad7f, 0x457eb3c9d0690fc1, 0xbe236d862a945ebb, 0x132eb28941cffde5, 0x1e7acb1bc5652b50, 0x0ddec69780b369c6, 0x95c3860bb4e256fe, 0x4fd826efce718ddd}}, {{ 0xc707685dbe6686a7, 0xebeb6a02f6353f88, 0x5bc460d779991298, 0x73ebcd43ca140722, 0xc3f4c55958a921ec, 0xe7e54b93bbfa22b1, 0xfe07fe44b53af4c5, 0x21795aa9278d1bba}, {0xe791350e920deb, 0x8efc455780c3d905, 0xb4de867941210302, 0xf3bb47dd16458096, 0x8dd452d1b7a2f6fd, 0x8a727469988f2003, 0x538c36075e022606, 0xdce8ba1f5023d90f}}, {{ 0xcfa242908638b3ad, 0x93df9dd8b9ffd4b0, 0x4bfdbb1c07e273e3, 0x14eb74f2f8d95497, 0x537c4b7cf3622493, 0xf873e7da6cebd73d, 0x72299f93154a7666, 0x42e703ff110605f5}, {0x011e83635ef82c4, 0xa91490f94342bd6a, 0x2b6008f01f52aa68, 0x1d4f39502ad185d8, 0x6e5dd128d1fc5dd4, 0xd4881872d26d905f, 0x15ac4926faed5098, 0x4bcced00840cc7fe}}, {{ 0x975f45dbd399788c, 0x55f48ce09c0c10d7, 0x097f0b17ef3d1d92, 0x20c788c43ec23d96, 0x59986c3f59b05e59, 0x3c804a2338304aed, 0xd0368ac2f53a9123, 0x47c1147be85c96a5}, {0x701f1e4cea1edc6e, 0xb64ddb851c7c6255, 0x8fe07795ca48b67f, 0xcaa969af6a7d2718, 0x43d5b45b6fc70351, 0x6f7aaa2e9eeeb9ea, 0x29320cf9c6bd2e90, 0x10bf7907d07fcce4}}, {{ 0x511c42ef05357d24, 0xf968e3bf8b3e87f4, 0xa6c11d931e55037d, 0xdb675691f4f22c23, 0xe5af40a2f0c6373c, 0xd2a5dd9b5562bca0, 0x12a56c8ed3957af3, 0x1ec38965e81871c4}, {0xe6ee767d87cd5afc, 0xd47141207f9dcfe5, 0x4914d7acead6a0ec, 0x8e834ae7b52a42e3, 0xd515182e90640650, 0x7f895719a11fc951, 0xc7a6ac9b52625206, 0x3f706daaf797437b}}, {{ 0xcf6ffd34407ee108, 0xfb283d82382abdaa, 0x667438c9cbf537c0, 0xcf9b429a9d7be29c, 0x9541f0eea0fbaaf1, 0x6d92ea9fd2e658ab, 0xf098ad8a855f5b9a, 0x89a07e4e88ade49c}, {0x01ba3833b66b902b, 0x4cf692c52dae06e7, 0x8a7c94f38a95691e, 0x4e01319ec4e31ae0, 0xab8712ffb0f84e02, 0x2066a36b111b9f36, 0xc68213abe6ac9e58, 0x36e374dc70d1a2aa}}, {{ 0x738d00231c7c9f34, 0xc3e7b1300ea524ad, 0x0c9d146b8c6929f1, 0x2c6891ec65b6e3ec, 0xd8fab329c2c90c6e, 0x423e948a728374bb, 0x4bda1d684d40835a, 0x6be5e9e3b9a32d70}, {0xf6ef0b031afeff97, 0xde13f1ebe8688f3d, 0x5fa8420a7acd0197, 0x207403fa608d7752, 0xb4f69c05ca33f028, 0xf32b97b89cb2b443, 0x13cc6ac8ea4373ca, 0x297c4a972663e3b8}}, {{ 0x7c26689bfcec229e, 0x2725adf1e93a2c8e, 0x442e2e2abcf28a8e, 0x2358cc14c55ad542, 0xfb78924824da8020, 0xe1e0cf47e511d9cc, 0x8bf9a09a598ba1c0, 0x5f49458f18084394}, {0x1266fc054842909c, 0x92c88977ba941c60, 0x7dbbe0b92d1da94a, 0x451f08a4cd57d352, 0x12f6d6ec68a635df, 0x7bb9ae277d2addc0, 0xb08d883f8688419f, 0x22e5cd1a96fe9bf4}}, {{ 0xd630f88869071b8e, 0x29e509a0f6af9956, 0x0c95b117dd4b4934, 0x4d41cc96ac5b870e, 0x42124641c8233a18, 0x9033a437ee06cbe1, 0x9d9ad3c5333ed1f4, 0x5ed0aa33e95e6ec8}, {0x151c7bcb316b0ce9, 0x94f6fcf316aad484, 0xe78028c182fe94d6, 0xa8c86e4e2bd56621, 0x333464259b330b41, 0xf3e2d8a7b921eaee, 0xfc88035e39d0e344, 0x72ed46006c4b6e4c}}, {{ 0x03fda495c2df9ede, 0x102f3cf85ff19d36, 0xca0bc91d70a82a82, 0x0ffc3ffd1bdd6d0a, 0x76b6ad558f25f8ba, 0x778bc76dfd604c7f, 0x7c33cd2c6bf4becd, 0x7b0e75df0c6c99c9}, {0x444570c1ec78ca2f, 0x7fbe7892a6811d8f, 0xf459dc6ac453562a, 0x935995e5deb0dda3, 0x01b760ac69cc3863, 0x7b942a2951740a0c, 0x9bc8ec7b0982e80e, 0x515f014894a0c962}}, {{ 0xdc6e2b6f94c525d7, 0xb6928028bbeea6ec, 0x30d12ecda7a608b3, 0xfe88f8c7e660f8af, 0x4451f4fd0384310d, 0x98d4c963eb6ed9f7, 0xee446e6153cf5e70, 0xa4fbf6471cad4e7c}, {0xe65558d531f4a08d, 0x0c89384acd02ec4a, 0xbae790b19422c2f8, 0xee4adbb54b1fe60d, 0x7ffe6781a0e983d0, 0x150348cbbf26feac, 0x74ba1c6a30224971, 0x2bcf577f6f4ac225}}};
const fp2_t Z_NQR_TABLE[20] = { {{ 0xffda34b95c5b2654, 0xba7d815c0e1a0c76, 0x2909f9d015d38cf5, 0xc13a6714b8bfd82e, 0xd3026bbdc4cf3ee0, 0x2acfdc13a4270f9a, 0x949765e7a3f8de53, 0x4e4666b8e48024a5}, {0x286019abe531b6e, 0x2b090b1371eb2134, 0x86cf54b48acbe473, 0x272fbe5078a4c73e, 0x1567b9157ba2caa3, 0xc6367a361d4565c1, 0xc8e570716364cf1d, 0xcdc58cda47ad9bc9}}, {{ 0x03f91bf73352ca33, 0x8754bd04277587c8, 0xf5b89b49c0f24322, 0xef9a1c486a8d1cff, 0x994acd32b1a65e14, 0xc431560ebe4e1eb9, 0x807518fd742f2abb, 0x792de83104b721b7}, {0xa9720f618ff0852c, 0xfccbe31a5a76d1ed, 0x1ee78b18973297ee, 0x02d4d42ba1c510b3, 0x83090caf7e0d2ad1, 0x6159cfd02e86805e, 0x3689ab33968ad37a, 0x74aae41a0fa88fc3}}, {{ 0xb897e1a4e69a71f6, 0xf19178bcc1a835e0, 0x84f4f40c1c929485, 0xc939e506ff53837a, 0xdce499749bc10080, 0x584d5a2f2861e651, 0xc003706f63b1bbb7, 0x3021496d8d177416}, {0x6ddeca9f704065ef, 0x8a5df680548f35af, 0xab424d79edc9cfae, 0x5355885d21cb32d1, 0xf089d0b1a0c19529, 0x85e5ab438d60db26, 0x126f0fe065fb43e7, 0x615a16c90bf7bd36}}, {{ 0xbb85308c36536bd2, 0xe42d1d91a1b3d77d, 0xdd22568d3b4634ee, 0x6c3bc6d13796ed13, 0x8acd8ea6a0f121af, 0x5352899891f03524, 0xdec52ff72e74c757, 0x8855108ad3070880}, {0xf23ede0d4e94a7ca, 0x3778c7d88f49fdc6, 0xf642b0ce71576561, 0xd7031eef7670f4a8, 0x36e37837539aadea, 0xf501dac75d847fec, 0xf4055f558318b8f6, 0x3b355ee3856ffea7}}, {{ 0xbefb767134d67d8, 0xf4bd0725bc629a8a, 0xa074ab13462afb32, 0x52ac5f28a4a374f2, 0xb16d4b29b5bbae24, 0xed9f4da374a2f54e, 0x75590a8d1a13c2f9, 0xc41fe2e8114687cf}, {0x90e9994b2a934958, 0x287a48ce992d935f, 0xe0b5d27fc874aff9, 0x2af305fe5ba7142a, 0x4f1afa185bacafd1, 0x00516336e3866da6, 0x427c283482568cf4, 0x8998852d14c3631d}}, {{ 0xf112d8e791e88d75, 0x3c6ba1e014772b47, 0xaa5832cdbdb6876d, 0x8ca183ad29df53ee, 0xc1919ddad58b3b1b, 0x157e5fb5a41f2a71, 0x9bb208436794eff3, 0x892e847333765120}, {0xe537b8e68b053d3e, 0xc486661a4f23ba33, 0xab950bd0b31522ec, 0xbe633a09948c7c38, 0xffa46cbfcc94267f, 0x8fe279f267ce3816, 0x230ff15621ea3668, 0x8fca23165d6bf787}}, {{ 0xb3515e372a09b5b2, 0xc887c20cbba03523, 0x7aad645787c4374b, 0xd8b661dbc0e625c7, 0x7c24d1dbc11dc0a1, 0x985667cb80d4bead, 0x992e0be771e89953, 0x35b1df5cb4ddae03}, {0xc56f28e3219d0f60, 0xefcc6a6482f60abc, 0xd42e2520d1d855bd, 0x42bb2e60ba971fe2, 0x3c60d26d92d37aad, 0xc798b9b3e4e7dc1b, 0x3bf3466c8f673133, 0x8317939e6c0e897b}}, {{ 0xc0331d6c4656d70e, 0x96e48f2dc4286089, 0x5f81eb1610506f4b, 0x47c9e068c0caaf35, 0x684d30c8e3f1f61d, 0xdbf57a227a2c01d1, 0x83d52d752fc737cc, 0x8fd3a9f810c47d8b}, {0xb583220dcddeb72e, 0xb466d658723cac13, 0x924d4acf4a8bdd68, 0x96933cf95f95d539, 0xdca94dad072b913d, 0x99b3381f897fc963, 0x8bd389879f44af9a, 0x1abb8380291babfb}}, {{ 0x5fec64d39d7c2097, 0x802721f6ff0ad17a, 0x86e4be17074a062f, 0x0514bcb84e98d672, 0x54641f8df269ea4d, 0x972617f87257c6ed, 0xd44d2183e1bfef5b, 0x2d1014e24e3b203a}, {0x89be8c503886b416, 0xd35b1209073de3da, 0x519cf95d11fc6e54, 0x93e63c8265b8dcb7, 0x37ccf75e692d1a5f, 0x25f552bb371dcc45, 0xb67b53206020ba94, 0x19133567af0f08d0}}, {{ 0xb602d20d4b7c2b9e, 0x36665ba9138f39a1, 0x8a244c1105552970, 0x0fda6d49a51a4e93, 0x747f32d5e6d544c8, 0x3d52e2a0d572fde8, 0xaf3641a93e667552, 0x53c908e51035e0d3}, {0x8bca0768b190134f, 0xd217dcfb8a6511a4, 0x2f135f8e7ebba652, 0x1b8d470a1c76aa67, 0x5281e48e3e2c481c, 0xd52f08e0fcaa7bb5, 0x24e93dd6531255e9, 0x5c54b350ecf93937}}, {{ 0x04506ea85faaa717, 0x68c0894f4cbcd2cc, 0x328042d20f031d12, 0xda269684cd2eb3e6, 0x6eb556517bd114ab, 0x0a7cd9e04e467fe7, 0x6b652a2ad2934f24, 0x3c68ffde71a836b1}, {0x70841bfe362692d8, 0x0f51e03ab8fa6440, 0xc747c74aa9984313, 0x35b57785d791da35, 0x3ecf4bc26bc92300, 0xea9cff9b7f65979c, 0x29aee0bba79e4359, 0x290839136968101d}}, {{ 0x6898663a8b7575a, 0xc49a0b42a230f8d1, 0x28caed2caa1cf4da, 0x72d9baf5ad8c5e4e, 0x9ec88e9b1abc8ed5, 0xadd31d8664ed2eeb, 0xe154b7b6a338f457, 0xde745e71c31be825}, {0x6b8fba2e3c38ca59, 0x46f480e2929b41d9, 0xe83dea037d777431, 0x99231789fc443583, 0xa31cf5469b2873a4, 0x0eb08a60dbb92f8d, 0x8dfb13b78eb2dd62, 0x32a47bd5920e6945}}, {{ 0x107760e6ca7fc68a, 0xbd93d785e107e4bc, 0x171f12fa2a4010d8, 0x0f4574e110697061, 0x352244eca02a6928, 0x33e400d3887fa0a8, 0x756238ee34bb4913, 0x6578141c1698d609}, {0x94eccad8f65ff875, 0x576f7b3d05b84078, 0x08a784da80e63f77, 0x9bb0f0069a722eb2, 0x6efb6f49e9deafa9, 0x6bdde7e7a354aae0, 0xf1668e2573bb6229, 0x8354c863b6b60739}}, {{ 0x5ae88be391853f65, 0xb52690978fed5186, 0x948e3a3911c55685, 0x8dd35e1eadd774cd, 0x7c86eb105f5f445e, 0xb12be3f3569d38c0, 0x91637878e8abf82d, 0x7adf14f4baf13018}, {0xbaa729e61f101512, 0x6674393440634c7f, 0xf6f5bc76b871ab09, 0x8fd9d70822e25677, 0xdc65b2c6d75adccc, 0xb1a64e04ead8cf06, 0xd8c7ca4b035287e6, 0x828e3ceb81954122}}, {{ 0x1017d81eac395820, 0x805e4585f698c0f0, 0x74284c5ef4ba5c24, 0x087b700023fba181, 0x4233d9e484d08bf0, 0x761d7c46b4b983b6, 0x5804afa61b4b4767, 0x33f575c73322f3ac}, {0x958ca9c405429445, 0xc49b00c0c4bcda8e, 0x109470f240a755ab, 0xb4c6508ecfd0eb93, 0x4c00941422383bb8, 0x02181463b6cf7d84, 0x99e0fd786a1b9d48, 0x925f32a68ede5710}}, {{ 0x98cd2f464894b88c, 0x431ec33a462b439c, 0x96b7e2f5b5fb0610, 0xd3ddd3ef213f1d73, 0xf0e4b88e8561f363, 0xfbd3c42b1ec150d8, 0x7e4d0dafead51ef1, 0x265edb4db48a3198}, {0x68555277be21cf0, 0x1a2389e4a5ba7226, 0xa87e56fb9029742a, 0x7e9578c653dd0ee6, 0xd6966e75d9f8b594, 0x690bf8375111073e, 0x04040b285d4539f2, 0xebd5c47534bb91b0}}, {{ 0xfbffc50ab6411a04, 0x88ef6585972704a1, 0xc74469cffdd58151, 0x85162430d59c47b9, 0xcaebd890f479c7b3, 0xf40de93042635188, 0x9c955b523068129a, 0x10cc1b6213d6384f}, {0xda6fa7cc945e18e7, 0x66fa8f72cf5048b3, 0xb8c23c7e47e6337a, 0x1dd7fd1bb5ee2ff1, 0xb19f49201cd55640, 0x292a12814b48162a, 0xbc12f5ee4078fa63, 0x33841f37e9c3d185}}, {{ 0x51b19487132a5394, 0xe5dcd896d91df597, 0xa164d7960ca4e046, 0xf52191a8b204e5a4, 0x7c40a386fa62e396, 0x78cb4559c0f39752, 0x3149b1c022a81b16, 0x717bd80d9f80c6c8}, {0x3225f9903a739d2a, 0xa1d1683231c8c2d3, 0x8793afd324bfd237, 0x83649721953a0ac2, 0x1a1ffbd9f132cf6f, 0xc178fbbc2ab3ce3e, 0xf1db821d8e7ab32f, 0x718d006b03e0ba3e}}, {{ 0x368660b0ef735c16, 0x17abc7391776afda, 0x341f0e1c073ddc3c, 0x10a45aadae122da5, 0xc7b56053d2605bb0, 0x1bcb6bb55f5f5e97, 0x86e818c3cfac1dd1, 0x7de6e0afda246d99}, {0x652393ffb540099a, 0x9467ddc33f5a3de2, 0xcdbd8ad6dcd2c37f, 0x33a30ceda245f5d1, 0x2862aad376bcd05e, 0xe57aa0499a475d31, 0x7769092e4a7cedc4, 0x24c6c616a680720d}}, {{ 0x0c63da200e5c79ff, 0xe2bc83531f301399, 0xd62084d994d78092, 0xfa016942c5aea5e0, 0xaf87e733513a181e, 0x34b4063b72431c72, 0x685c4a630e9de055, 0x1bbc05efa7696643}, {0x451a10bd324731d2, 0x7cee1194c5b6d4f7, 0x45d0ef0d937929a5, 0x4e2d7046fe8b5dfc, 0x04fae0d07cb60fcd, 0x05c40031bf69a5d1, 0xea6538c40d75c55a, 0x933ce14fd5309eda}}};

const digit_t p_cofactor_for_2f[NWORDS_P_COFACTOR_FOR_2F] = {0x80429e2d58ebb467, 0x52e830945c1a0446, 0x5eec151f0a69c447, 0xa65f4ee938387923};
const uint16_t P_COFACTOR_FOR_2F_BITLENGTH = 256;
const uint16_t POWER_OF_2 = 256;
